<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Crypto.Padding</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">crypto-api-0.13.3: A generic interface for cryptographic operations</span><ul class="links" id="page-menu"><li><a href="src/Crypto.Padding.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Maintainer</th><td>Thomas.DuBuisson@gmail.com</td></tr><tr><th>Stability</th><td>beta</td></tr><tr><th>Portability</th><td>portable</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Crypto.Padding</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">PKCS5 (RFC 1423) based [un]padding routines</a></li><li><a href="#g:2">ESP (RFC 4303) [un]padding routines</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>PKCS5 (RFC 1423) and IPSec ESP (RFC 4303)
padding methods are implemented both as trivial functions operating on
bytestrings and as <code><a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:PutM" title="Data.Serialize.Put">PutM</a></code> routines usable from the <a href="../cereal-0.5.8.3/Data-Serialize.html">Data.Serialize</a>
module.  These methods do not work for algorithms or pad sizes in
excess of 255 bytes (2040 bits, so extremely large as far as cipher
needs are concerned).</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:padPKCS5">padPKCS5</a> :: <a href="Crypto-Types.html#t:ByteLength" title="Crypto.Types">ByteLength</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:padBlockSize">padBlockSize</a> :: <a href="Crypto-Classes.html#t:BlockCipher" title="Crypto.Classes">BlockCipher</a> k =&gt; k -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:putPaddedPKCS5">putPaddedPKCS5</a> :: <a href="Crypto-Types.html#t:ByteLength" title="Crypto.Types">ByteLength</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:Put" title="Data.Serialize.Put">Put</a></li><li class="src short"><a href="#v:unpadPKCS5safe">unpadPKCS5safe</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:unpadPKCS5">unpadPKCS5</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:padESP">padESP</a> :: <a href="../base-4.18.2.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:unpadESP">unpadESP</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:padESPBlockSize">padESPBlockSize</a> :: <a href="Crypto-Classes.html#t:BlockCipher" title="Crypto.Classes">BlockCipher</a> k =&gt; k -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:putPadESPBlockSize">putPadESPBlockSize</a> :: <a href="Crypto-Classes.html#t:BlockCipher" title="Crypto.Classes">BlockCipher</a> k =&gt; k -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:Put" title="Data.Serialize.Put">Put</a></li><li class="src short"><a href="#v:putPadESP">putPadESP</a> :: <a href="../base-4.18.2.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:Put" title="Data.Serialize.Put">Put</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>PKCS5 (RFC 1423) based [un]padding routines</h1></a><div class="top"><p class="src"><a id="v:padPKCS5" class="def">padPKCS5</a> :: <a href="Crypto-Types.html#t:ByteLength" title="Crypto.Types">ByteLength</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Padding.html#padPKCS5" class="link">Source</a> <a href="#v:padPKCS5" class="selflink">#</a></p><div class="doc"><p>PKCS5 (aka RFC1423) padding method.
 This method will not work properly for pad modulos &gt; 256</p></div></div><div class="top"><p class="src"><a id="v:padBlockSize" class="def">padBlockSize</a> :: <a href="Crypto-Classes.html#t:BlockCipher" title="Crypto.Classes">BlockCipher</a> k =&gt; k -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Padding.html#padBlockSize" class="link">Source</a> <a href="#v:padBlockSize" class="selflink">#</a></p><div class="doc"><p>PKCS5 (aka RFC1423) padding method using the BlockCipher instance
 to determine the pad size.</p></div></div><div class="top"><p class="src"><a id="v:putPaddedPKCS5" class="def">putPaddedPKCS5</a> :: <a href="Crypto-Types.html#t:ByteLength" title="Crypto.Types">ByteLength</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:Put" title="Data.Serialize.Put">Put</a> <a href="src/Crypto.Padding.html#putPaddedPKCS5" class="link">Source</a> <a href="#v:putPaddedPKCS5" class="selflink">#</a></p><div class="doc"><p>Ex:</p><pre>    putPaddedPKCS5 m bs
</pre><p>Will pad out <code>bs</code> to a byte multiple
 of <code>m</code> and put both the bytestring and it's padding via <code><a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:PutM" title="Data.Serialize.Put">PutM</a></code>
 (this saves on copying if you are already using Cereal).</p></div></div><div class="top"><p class="src"><a id="v:unpadPKCS5safe" class="def">unpadPKCS5safe</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Padding.html#unpadPKCS5safe" class="link">Source</a> <a href="#v:unpadPKCS5safe" class="selflink">#</a></p><div class="doc"><p>unpad a strict bytestring padded in the typical PKCS5 manner.
 This routine verifies all pad bytes and pad length match correctly.</p></div></div><div class="top"><p class="src"><a id="v:unpadPKCS5" class="def">unpadPKCS5</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Padding.html#unpadPKCS5" class="link">Source</a> <a href="#v:unpadPKCS5" class="selflink">#</a></p><div class="doc"><p>unpad a strict bytestring without checking the pad bytes and
 length any more than necessary.</p></div></div><a href="#g:2" id="g:2"><h1>ESP (RFC 4303) [un]padding routines</h1></a><div class="top"><p class="src"><a id="v:padESP" class="def">padESP</a> :: <a href="../base-4.18.2.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Padding.html#padESP" class="link">Source</a> <a href="#v:padESP" class="selflink">#</a></p><div class="doc"><p>Pad a bytestring to the IPSEC esp specification</p><pre>padESP m payload</pre><p>is equivilent to:</p><pre>              (msg)       (padding)       (length field)
    B.concat [payload, B.pack [1,2,3,4..], B.pack [padLen]]
</pre><p>Where:</p><ul><li>the msg is any payload, including TFC.</li><li>the padding is &lt;= 255</li><li>the length field is one byte.</li></ul><p>Notice the result bytesting length remainder <code>r</code> equals zero.  The lack
  of a &quot;next header&quot; field means this function is not directly useable for
  an IPSec implementation (copy/paste the 4 line function and add in a
  &quot;next header&quot; field if you are making IPSec ESP).</p></div></div><div class="top"><p class="src"><a id="v:unpadESP" class="def">unpadESP</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Padding.html#unpadESP" class="link">Source</a> <a href="#v:unpadESP" class="selflink">#</a></p><div class="doc"><p>unpad and return the padded message (<code><a href="../base-4.18.2.0/Data-Maybe.html#v:Nothing" title="Data.Maybe">Nothing</a></code> is returned if the padding is invalid)</p></div></div><div class="top"><p class="src"><a id="v:padESPBlockSize" class="def">padESPBlockSize</a> :: <a href="Crypto-Classes.html#t:BlockCipher" title="Crypto.Classes">BlockCipher</a> k =&gt; k -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Padding.html#padESPBlockSize" class="link">Source</a> <a href="#v:padESPBlockSize" class="selflink">#</a></p><div class="doc"><p>Like padESP but use the BlockCipher instance to determine padding size</p></div></div><div class="top"><p class="src"><a id="v:putPadESPBlockSize" class="def">putPadESPBlockSize</a> :: <a href="Crypto-Classes.html#t:BlockCipher" title="Crypto.Classes">BlockCipher</a> k =&gt; k -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:Put" title="Data.Serialize.Put">Put</a> <a href="src/Crypto.Padding.html#putPadESPBlockSize" class="link">Source</a> <a href="#v:putPadESPBlockSize" class="selflink">#</a></p><div class="doc"><p>Like putPadESP but using the BlockCipher instance to determine padding size</p></div></div><div class="top"><p class="src"><a id="v:putPadESP" class="def">putPadESP</a> :: <a href="../base-4.18.2.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:Put" title="Data.Serialize.Put">Put</a> <a href="src/Crypto.Padding.html#putPadESP" class="link">Source</a> <a href="#v:putPadESP" class="selflink">#</a></p><div class="doc"><p>Pad a bytestring to the IPSEC ESP specification using <code><a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:PutM" title="Data.Serialize.Put">PutM</a></code>.
 This can reduce copying if you are already using <code><a href="../cereal-0.5.8.3/Data-Serialize-Put.html#t:PutM" title="Data.Serialize.Put">PutM</a></code>.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>