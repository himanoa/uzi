<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Effectful.Concurrent.Chan</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">effectful-2.3.0.0: An easy to use, performant extensible effects library.</span><ul class="links" id="page-menu"><li><a href="src/Effectful.Concurrent.Chan.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Effectful.Concurrent.Chan</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Effect</a><ul><li><a href="#g:2">Handlers</a></li></ul></li><li><a href="#g:3">Chan</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Lifted <a href="../base-4.18.2.0/Control-Concurrent-Chan.html">Control.Concurrent.Chan</a>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Concurrent">Concurrent</a> :: <a href="../effectful-core-2.3.0.1/Effectful.html#t:Effect" title="Effectful">Effect</a></li><li class="src short"><a href="#v:runConcurrent">runConcurrent</a> :: <a href="../effectful-core-2.3.0.1/Effectful.html#t:IOE" title="Effectful">IOE</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> (<a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> : es) a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es a</li><li class="src short"><span class="keyword">data</span> <a href="#t:Chan">Chan</a> a</li><li class="src short"><a href="#v:newChan">newChan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es (<a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a)</li><li class="src short"><a href="#v:writeChan">writeChan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es ()</li><li class="src short"><a href="#v:readChan">readChan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es a</li><li class="src short"><a href="#v:dupChan">dupChan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es (<a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a)</li><li class="src short"><a href="#v:getChanContents">getChanContents</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es [a]</li><li class="src short"><a href="#v:writeList2Chan">writeList2Chan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; [a] -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es ()</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Effect</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Concurrent" class="def">Concurrent</a> :: <a href="../effectful-core-2.3.0.1/Effectful.html#t:Effect" title="Effectful">Effect</a> <a href="src/Effectful.Concurrent.Effect.html#Concurrent" class="link">Source</a> <a href="#t:Concurrent" class="selflink">#</a></p><div class="doc"><p>Provide the ability to run <code><a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a></code> computations concurrently in multiple
 threads and communicate between them.</p><p><em>Warning:</em> unless you stick to high level functions from the
 <code><a href="Effectful-Concurrent-Async.html#v:withAsync" title="Effectful.Concurrent.Async">withAsync</a></code> family, the <code><a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a></code> effect makes
 it possible to escape the scope of any scoped effect operation. Consider the
 following:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import qualified Effectful.Reader.Static as R
</code></strong></pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>printAsk msg = liftIO . putStrLn . (msg ++) . (&quot;: &quot; ++) =&lt;&lt; R.ask
</code></strong></pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>:{
</code></strong>  runEff . R.runReader &quot;GLOBAL&quot; . runConcurrent $ do
    a &lt;- R.local (const &quot;LOCAL&quot;) $ do
      a &lt;- async $ do
        printAsk &quot;child (first)&quot;
        threadDelay 20000
        printAsk &quot;child (second)&quot;
      threadDelay 10000
      printAsk &quot;parent (inside)&quot;
      pure a
    printAsk &quot;parent (outside)&quot;
    wait a
:}
child (first): LOCAL
parent (inside): LOCAL
parent (outside): GLOBAL
child (second): LOCAL
</pre><p>Note that the asynchronous computation doesn't respect the scope of
 <code><a href="../effectful-core-2.3.0.1/Effectful-Reader-Static.html#v:local" title="Effectful.Reader.Static">local</a></code>, i.e. the child thread still behaves like
 it's inside the <code><a href="../effectful-core-2.3.0.1/Effectful-Reader-Static.html#v:local" title="Effectful.Reader.Static">local</a></code> block, even though the parent
 thread already got out of it.</p><p>This is because the value provided by the <code><a href="../effectful-core-2.3.0.1/Effectful-Reader-Static.html#t:Reader" title="Effectful.Reader.Static">Reader</a></code>
 effect is thread local, i.e. each thread manages its own version of it. For
 the <code><a href="../effectful-core-2.3.0.1/Effectful-Reader-Static.html#t:Reader" title="Effectful.Reader.Static">Reader</a></code> it is the only reasonable behavior, it
 wouldn't be very useful if its &quot;read only&quot; value was affected by calls to
 <code><a href="../effectful-core-2.3.0.1/Effectful-Reader-Static.html#v:local" title="Effectful.Reader.Static">local</a></code> from its parent or child threads.</p><p>However, the cut isn't so clear if it comes to effects that provide access to
 a mutable state. That's why statically dispatched <code>State</code> and <code>Writer</code>
 effects come in two flavors, local and shared:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import qualified Effectful.State.Static.Local as SL
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>:{
</code></strong>  runEff . SL.execState &quot;Hi&quot; . runConcurrent $ do
    replicateConcurrently_ 3 $ SL.modify (++ &quot;!&quot;)
:}
&quot;Hi&quot;
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import qualified Effectful.State.Static.Shared as SS
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>:{
</code></strong>  runEff . SS.execState &quot;Hi&quot; . runConcurrent $ do
    replicateConcurrently_ 3 $ SS.modify (++ &quot;!&quot;)
:}
&quot;Hi!!!&quot;
</pre><p>In the first example state updates made concurrently are not reflected in the
 parent thread because the value is thread local, but in the second example
 they are, because the value is shared.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Concurrent">Instances</h4><details id="i:Concurrent" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Concurrent:DispatchOf:1"></span> <span class="keyword">type</span> <a href="../effectful-core-2.3.0.1/Effectful.html#t:DispatchOf" title="Effectful">DispatchOf</a> <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a></span> <a href="src/Effectful.Concurrent.Effect.html#line-77" class="link">Source</a> <a href="#t:Concurrent" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Concurrent:DispatchOf:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Effectful-Concurrent-Effect.html">Effectful.Concurrent.Effect</a></p> <div class="src"><span class="keyword">type</span> <a href="../effectful-core-2.3.0.1/Effectful.html#t:DispatchOf" title="Effectful">DispatchOf</a> <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> = '<a href="../effectful-core-2.3.0.1/Effectful.html#v:Static" title="Effectful">Static</a> '<a href="../effectful-core-2.3.0.1/Effectful-Dispatch-Static.html#v:WithSideEffects" title="Effectful.Dispatch.Static">WithSideEffects</a></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Concurrent:StaticRep:2"></span> <span class="keyword">data</span> <a href="../effectful-core-2.3.0.1/Effectful-Dispatch-Static.html#t:StaticRep" title="Effectful.Dispatch.Static">StaticRep</a> <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a></span> <a href="src/Effectful.Concurrent.Effect.html#line-78" class="link">Source</a> <a href="#t:Concurrent" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Concurrent:StaticRep:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Effectful-Concurrent-Effect.html">Effectful.Concurrent.Effect</a></p> <div class="src"><span class="keyword">data</span> <a href="../effectful-core-2.3.0.1/Effectful-Dispatch-Static.html#t:StaticRep" title="Effectful.Dispatch.Static">StaticRep</a> <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> = <a id="v:Concurrent" class="def">Concurrent</a></div></details></td></tr></table></details></div></div><a href="#g:2" id="g:2"><h2>Handlers</h2></a><div class="top"><p class="src"><a id="v:runConcurrent" class="def">runConcurrent</a> :: <a href="../effectful-core-2.3.0.1/Effectful.html#t:IOE" title="Effectful">IOE</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> (<a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> : es) a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es a <a href="src/Effectful.Concurrent.Effect.html#runConcurrent" class="link">Source</a> <a href="#v:runConcurrent" class="selflink">#</a></p><div class="doc"><p>Run the <code><a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a></code> effect.</p></div></div><a href="#g:3" id="g:3"><h1>Chan</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Chan" class="def">Chan</a> a <a href="#t:Chan" class="selflink">#</a></p><div class="doc"><p><code><a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a></code> is an abstract type representing an unbounded FIFO channel.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Chan">Instances</h4><details id="i:Chan" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Chan:Eq:1"></span> <a href="../base-4.18.2.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a)</span></td><td class="doc"><p><em>Since: base-4.4.0.0</em></p></td></tr><tr><td colspan="2"><details id="i:id:Chan:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="../base-4.18.2.0/Control-Concurrent-Chan.html">Control.Concurrent.Chan</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="../base-4.18.2.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="../base-4.18.2.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:newChan" class="def">newChan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es (<a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a) <a href="src/Effectful.Concurrent.Chan.html#newChan" class="link">Source</a> <a href="#v:newChan" class="selflink">#</a></p><div class="doc"><p>Lifted <code><a href="../base-4.18.2.0/Control-Concurrent-Chan.html#v:newChan" title="Control.Concurrent.Chan">newChan</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:writeChan" class="def">writeChan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es () <a href="src/Effectful.Concurrent.Chan.html#writeChan" class="link">Source</a> <a href="#v:writeChan" class="selflink">#</a></p><div class="doc"><p>Lifted <code><a href="../base-4.18.2.0/Control-Concurrent-Chan.html#v:writeChan" title="Control.Concurrent.Chan">writeChan</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:readChan" class="def">readChan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es a <a href="src/Effectful.Concurrent.Chan.html#readChan" class="link">Source</a> <a href="#v:readChan" class="selflink">#</a></p><div class="doc"><p>Lifted <code><a href="../base-4.18.2.0/Control-Concurrent-Chan.html#v:readChan" title="Control.Concurrent.Chan">readChan</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:dupChan" class="def">dupChan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es (<a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a) <a href="src/Effectful.Concurrent.Chan.html#dupChan" class="link">Source</a> <a href="#v:dupChan" class="selflink">#</a></p><div class="doc"><p>Lifted <code><a href="../base-4.18.2.0/Control-Concurrent-Chan.html#v:dupChan" title="Control.Concurrent.Chan">dupChan</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:getChanContents" class="def">getChanContents</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es [a] <a href="src/Effectful.Concurrent.Chan.html#getChanContents" class="link">Source</a> <a href="#v:getChanContents" class="selflink">#</a></p><div class="doc"><p>Lifted <code><a href="../base-4.18.2.0/Control-Concurrent-Chan.html#v:getChanContents" title="Control.Concurrent.Chan">getChanContents</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:writeList2Chan" class="def">writeList2Chan</a> :: <a href="Effectful-Concurrent-Chan.html#t:Concurrent" title="Effectful.Concurrent.Chan">Concurrent</a> <a href="../effectful-core-2.3.0.1/Effectful.html#t::-62-" title="Effectful">:&gt;</a> es =&gt; <a href="Effectful-Concurrent-Chan.html#t:Chan" title="Effectful.Concurrent.Chan">Chan</a> a -&gt; [a] -&gt; <a href="../effectful-core-2.3.0.1/Effectful.html#t:Eff" title="Effectful">Eff</a> es () <a href="src/Effectful.Concurrent.Chan.html#writeList2Chan" class="link">Source</a> <a href="#v:writeList2Chan" class="selflink">#</a></p><div class="doc"><p>Lifted <code><a href="../base-4.18.2.0/Control-Concurrent-Chan.html#v:writeList2Chan" title="Control.Concurrent.Chan">writeList2Chan</a></code>.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>