<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-noncanonical-monad-instances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK not-home #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- | The 'Eff' monad.</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- This module is intended for internal use only, and may change without warning</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- in subsequent releases.</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Effectful.Internal.Monad</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * The 'Eff' monad</span></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier">Eff</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#runPureEff"><span class="hs-identifier">runPureEff</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Access to the internal representation</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier">unEff</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier">unsafeEff</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier">unsafeEff_</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-comment">-- * NonDet</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#NonDet"><span class="hs-identifier">NonDet</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Fail</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Fail"><span class="hs-identifier">Fail</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-comment">-- * IO</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier">IOE</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#runEff"><span class="hs-identifier">runEff</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Prim</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Prim"><span class="hs-identifier">Prim</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#PrimStateEff"><span class="hs-identifier">PrimStateEff</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#runPrim"><span class="hs-identifier">runPrim</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Lifting</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#raise"><span class="hs-identifier">raise</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#raiseWith"><span class="hs-identifier">raiseWith</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#subsume"><span class="hs-identifier">subsume</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#inject"><span class="hs-identifier">inject</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#Subset"><span class="hs-identifier">Subset</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Unlifting</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#UnliftStrategy"><span class="hs-identifier">UnliftStrategy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#Persistence"><span class="hs-identifier">Persistence</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#Limit"><span class="hs-identifier">Limit</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#unliftStrategy"><span class="hs-identifier">unliftStrategy</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#withUnliftStrategy"><span class="hs-identifier">withUnliftStrategy</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#withSeqEffToIO"><span class="hs-identifier">withSeqEffToIO</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#withEffToIO"><span class="hs-identifier">withEffToIO</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#withConcEffToIO"><span class="hs-identifier">withConcEffToIO</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Low-level unlifts</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#seqUnliftIO"><span class="hs-identifier">seqUnliftIO</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#concUnliftIO"><span class="hs-identifier">concUnliftIO</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Dispatch</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Dynamic dispatch</span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#EffectHandler"><span class="hs-identifier">EffectHandler</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#LocalEnv"><span class="hs-identifier">LocalEnv</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier">Handler</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#relinkHandler"><span class="hs-identifier">relinkHandler</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#runHandler"><span class="hs-identifier">runHandler</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#send"><span class="hs-identifier">send</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Static dispatch</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier">StaticRep</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#MaybeIOE"><span class="hs-identifier">MaybeIOE</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#runStaticRep"><span class="hs-identifier">runStaticRep</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#evalStaticRep"><span class="hs-identifier">evalStaticRep</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#execStaticRep"><span class="hs-identifier">execStaticRep</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#getStaticRep"><span class="hs-identifier">getStaticRep</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#putStaticRep"><span class="hs-identifier">putStaticRep</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#stateStaticRep"><span class="hs-identifier">stateStaticRep</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#stateStaticRepM"><span class="hs-identifier">stateStaticRepM</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#localStaticRep"><span class="hs-identifier">localStaticRep</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><span class="hs-comment">-- *** Primitive operations</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#consEnv"><span class="hs-identifier">consEnv</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#getEnv"><span class="hs-identifier">getEnv</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#putEnv"><span class="hs-identifier">putEnv</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#stateEnv"><span class="hs-identifier">stateEnv</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#modifyEnv"><span class="hs-identifier">modifyEnv</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Base</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fix</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Unlift</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Primitive</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Constraint</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">oneShot</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeDupablePerformIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeCoerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html"><span class="hs-identifier">Effectful.Internal.Effect</span></a></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html"><span class="hs-identifier">Effectful.Internal.Env</span></a></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html"><span class="hs-identifier">Effectful.Internal.Unlift</span></a></span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Effectful.Internal.Utils.html"><span class="hs-identifier">Effectful.Internal.Utils</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">role</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span> </span><span class="annot"><span class="hs-identifier">representational</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | The 'Eff' monad provides the implementation of a computation that performs</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- an arbitrary set of effects. In @'Eff' es a@, @es@ is a type-level list that</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- contains all the effects that the computation may perform. For example, a</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- computation that produces an 'Integer' by consuming a 'String' from the</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- global environment and acting upon a single mutable value of type 'Bool'</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- would have the following type:</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- ('Effectful.Reader.Static.Reader' 'String' ':&gt;' es, 'Effectful.State.Static.Local.State' 'Bool' ':&gt;' es) =&gt; 'Eff' es 'Integer'</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- Abstracting over the list of effects with '(:&gt;)':</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- - Allows the computation to be used in functions that may perform other</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- effects.</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- - Allows the effects to be handled in any order.</span><span>
</span><span id="line-126"></span><span class="hs-keyword">newtype</span><span> </span><span id="Eff"><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-var">Eff</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075798"><span class="annot"><a href="#local-6989586621679075798"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679075799"><span class="annot"><a href="#local-6989586621679075799"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Eff"><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-var">Eff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075798"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075799"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075806"><span id="local-6989586621679075812"><span id="local-6989586621679075817"><span class="annot"><span class="annottext">Semigroup (Eff es a)
Eff es a
Semigroup (Eff es a) =&gt;
Eff es a
-&gt; (Eff es a -&gt; Eff es a -&gt; Eff es a)
-&gt; ([Eff es a] -&gt; Eff es a)
-&gt; Monoid (Eff es a)
[Eff es a] -&gt; Eff es a
Eff es a -&gt; Eff es a -&gt; Eff es a
forall (es :: [Effect]) a. Monoid a =&gt; Semigroup (Eff es a)
forall (es :: [Effect]) a. Monoid a =&gt; Eff es a
forall (es :: [Effect]) a. Monoid a =&gt; [Eff es a] -&gt; Eff es a
forall (es :: [Effect]) a.
Monoid a =&gt;
Eff es a -&gt; Eff es a -&gt; Eff es a
forall a.
Semigroup a =&gt;
a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
$cmempty :: forall (es :: [Effect]) a. Monoid a =&gt; Eff es a
mempty :: Eff es a
$cmappend :: forall (es :: [Effect]) a.
Monoid a =&gt;
Eff es a -&gt; Eff es a -&gt; Eff es a
mappend :: Eff es a -&gt; Eff es a -&gt; Eff es a
$cmconcat :: forall (es :: [Effect]) a. Monoid a =&gt; [Eff es a] -&gt; Eff es a
mconcat :: [Eff es a] -&gt; Eff es a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075827"><span id="local-6989586621679075833"><span id="local-6989586621679075840"><span class="annot"><span class="annottext">NonEmpty (Eff es a) -&gt; Eff es a
Eff es a -&gt; Eff es a -&gt; Eff es a
(Eff es a -&gt; Eff es a -&gt; Eff es a)
-&gt; (NonEmpty (Eff es a) -&gt; Eff es a)
-&gt; (forall b. Integral b =&gt; b -&gt; Eff es a -&gt; Eff es a)
-&gt; Semigroup (Eff es a)
forall (es :: [Effect]) a.
Semigroup a =&gt;
NonEmpty (Eff es a) -&gt; Eff es a
forall (es :: [Effect]) a.
Semigroup a =&gt;
Eff es a -&gt; Eff es a -&gt; Eff es a
forall (es :: [Effect]) a b.
(Semigroup a, Integral b) =&gt;
b -&gt; Eff es a -&gt; Eff es a
forall b. Integral b =&gt; b -&gt; Eff es a -&gt; Eff es a
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
$c&lt;&gt; :: forall (es :: [Effect]) a.
Semigroup a =&gt;
Eff es a -&gt; Eff es a -&gt; Eff es a
&lt;&gt; :: Eff es a -&gt; Eff es a -&gt; Eff es a
$csconcat :: forall (es :: [Effect]) a.
Semigroup a =&gt;
NonEmpty (Eff es a) -&gt; Eff es a
sconcat :: NonEmpty (Eff es a) -&gt; Eff es a
$cstimes :: forall (es :: [Effect]) a b.
(Semigroup a, Integral b) =&gt;
b -&gt; Eff es a -&gt; Eff es a
stimes :: forall b. Integral b =&gt; b -&gt; Eff es a -&gt; Eff es a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Run a pure 'Eff' computation.</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- For running computations with side effects see 'runEff'.</span><span>
</span><span id="line-132"></span><span id="local-6989586621679075357"><span class="annot"><a href="Effectful.Internal.Monad.html#runPureEff"><span class="hs-identifier hs-type">runPureEff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679075357"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075357"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-133"></span><span id="runPureEff"><span class="annot"><span class="annottext">runPureEff :: forall a. Eff '[] a -&gt; a
</span><a href="Effectful.Internal.Monad.html#runPureEff"><span class="hs-identifier hs-var hs-var">runPureEff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075850"><span class="annot"><span class="annottext">Env '[] -&gt; IO a
</span><a href="#local-6989586621679075850"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-comment">-- unsafeDupablePerformIO is safe here since IOE was not on the stack, so no</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-comment">-- IO with side effects was performed (unless someone sneakily introduced side</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-comment">-- effects with unsafeEff, but then all bets are off).</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-comment">-- Moreover, internals don't allocate any resources that require explicit</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-comment">-- cleanup actions to run.</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">IO a -&gt; a
forall a. IO a -&gt; a
</span><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; a) -&gt; IO a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env '[] -&gt; IO a
</span><a href="#local-6989586621679075850"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Env '[] -&gt; IO a) -&gt; IO (Env '[]) -&gt; IO a
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Env '[])
</span><a href="Effectful.Internal.Env.html#emptyEnv"><span class="hs-identifier hs-var">emptyEnv</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- Access to the internal representation</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><span class="hs-comment">-- | Peel off the constructor of 'Eff'.</span></span><span>
</span><span id="line-146"></span><span id="local-6989586621679075366"><span id="local-6989586621679075367"><span class="annot"><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-type">unEff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075366"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075367"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075366"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075367"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-147"></span><span id="unEff"><span class="annot"><span class="annottext">unEff :: forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var hs-var">unEff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075853"><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075853"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075853"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Access the underlying 'IO' monad along with the environment.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- This function is __unsafe__ because it can be used to introduce arbitrary</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- 'IO' actions into pure 'Eff' computations.</span><span>
</span><span id="line-153"></span><span id="local-6989586621679075370"><span id="local-6989586621679075371"><span class="annot"><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-type">unsafeEff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075370"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075371"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075370"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075371"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-154"></span><span id="unsafeEff"><span class="annot"><span class="annottext">unsafeEff :: forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var hs-var">unsafeEff</span></a></span></span><span> </span><span id="local-6989586621679075854"><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075854"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-var">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Env es -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-identifier hs-var">oneShot</span></span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075854"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Access the underlying 'IO' monad.</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- This function is __unsafe__ because it can be used to introduce arbitrary</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- 'IO' actions into pure 'Eff' computations.</span><span>
</span><span id="line-160"></span><span id="local-6989586621679075376"><span id="local-6989586621679075377"><span class="annot"><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-type">unsafeEff_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075376"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075377"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075376"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-161"></span><span id="unsafeEff_"><span class="annot"><span class="annottext">unsafeEff_ :: forall a (es :: [Effect]). IO a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-var hs-var">unsafeEff_</span></a></span></span><span> </span><span id="local-6989586621679075855"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679075855"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Env es
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679075855"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- Unlifting IO</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Get the current 'UnliftStrategy'.</span><span>
</span><span id="line-167"></span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- /Note:/ this strategy is implicitly used by the 'MonadUnliftIO' and</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- 'MonadBaseControl' instance for 'Eff'.</span><span>
</span><span id="line-170"></span><span id="local-6989586621679075381"><span class="annot"><a href="Effectful.Internal.Monad.html#unliftStrategy"><span class="hs-identifier hs-type">unliftStrategy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075381"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075381"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#UnliftStrategy"><span class="hs-identifier hs-type">UnliftStrategy</span></a></span></span><span>
</span><span id="line-171"></span><span id="unliftStrategy"><span class="annot"><span class="annottext">unliftStrategy :: forall (es :: [Effect]). (IOE :&gt; es) =&gt; Eff es UnliftStrategy
</span><a href="Effectful.Internal.Monad.html#unliftStrategy"><span class="hs-identifier hs-var hs-var">unliftStrategy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span id="local-6989586621679075865"><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="#local-6989586621679075865"><span class="hs-identifier hs-var">unlift</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff es (StaticRep IOE)
forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect]).
(DispatchOf e ~ 'Static sideEffects, e :&gt; es) =&gt;
Eff es (StaticRep e)
</span><a href="Effectful.Internal.Monad.html#getStaticRep"><span class="hs-identifier hs-var">getStaticRep</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><span class="annottext">UnliftStrategy -&gt; Eff es UnliftStrategy
forall a. a -&gt; Eff es a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="#local-6989586621679075865"><span class="hs-identifier hs-var">unlift</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><span class="hs-comment">-- | Locally override the current 'UnliftStrategy' with the given value.</span></span><span>
</span><span id="line-176"></span><span id="local-6989586621679075399"><span id="local-6989586621679075400"><span class="annot"><a href="Effectful.Internal.Monad.html#withUnliftStrategy"><span class="hs-identifier hs-type">withUnliftStrategy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075399"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#UnliftStrategy"><span class="hs-identifier hs-type">UnliftStrategy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075399"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075400"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075399"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075400"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-177"></span><span id="withUnliftStrategy"><span class="annot"><span class="annottext">withUnliftStrategy :: forall (es :: [Effect]) a.
(IOE :&gt; es) =&gt;
UnliftStrategy -&gt; Eff es a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#withUnliftStrategy"><span class="hs-identifier hs-var hs-var">withUnliftStrategy</span></a></span></span><span> </span><span id="local-6989586621679075870"><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="#local-6989586621679075870"><span class="hs-identifier hs-var">unlift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StaticRep IOE -&gt; StaticRep IOE) -&gt; Eff es a -&gt; Eff es a
forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect])
       a.
(DispatchOf e ~ 'Static sideEffects, e :&gt; es) =&gt;
(StaticRep e -&gt; StaticRep e) -&gt; Eff es a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#localStaticRep"><span class="hs-identifier hs-var">localStaticRep</span></a></span><span> </span><span class="annot"><span class="annottext">((StaticRep IOE -&gt; StaticRep IOE) -&gt; Eff es a -&gt; Eff es a)
-&gt; (StaticRep IOE -&gt; StaticRep IOE) -&gt; Eff es a -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">StaticRep IOE
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnliftStrategy -&gt; StaticRep IOE
</span><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-var">IOE</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="#local-6989586621679075870"><span class="hs-identifier hs-var">unlift</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Create an unlifting function with the 'SeqUnlift' strategy. For the general</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- version see 'withEffToIO'.</span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- /Note:/ usage of this function is preferrable to 'Effectful.withRunInIO'</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- because of explicit unlifting strategy and better error reporting.</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- @since 2.2.2.0</span><span>
</span><span id="line-186"></span><span id="local-6989586621679075408"><span id="local-6989586621679075410"><span class="annot"><a href="Effectful.Internal.Monad.html#withSeqEffToIO"><span class="hs-identifier hs-type">withSeqEffToIO</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075408"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075409"><span class="annot"><a href="#local-6989586621679075409"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075408"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075409"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075409"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075410"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Continuation with the unlifting function in scope.</span></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075408"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075410"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-191"></span><span id="withSeqEffToIO"><span class="annot"><span class="annottext">withSeqEffToIO :: forall (es :: [Effect]) a.
(HasCallStack, IOE :&gt; es) =&gt;
((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#withSeqEffToIO"><span class="hs-identifier hs-var hs-var">withSeqEffToIO</span></a></span></span><span> </span><span id="local-6989586621679075876"><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075876"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075877"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075877"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; IO a
forall (es :: [Effect]) a.
HasCallStack =&gt;
Env es -&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#seqUnliftIO"><span class="hs-identifier hs-var">seqUnliftIO</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075877"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075876"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Create an unlifting function with the given strategy.</span><span>
</span><span id="line-194"></span><span class="hs-comment">--</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- /Note:/ usage of this function is preferrable to 'Effectful.withRunInIO'</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- because of explicit unlifting strategy and better error reporting.</span><span>
</span><span id="line-197"></span><span id="local-6989586621679075416"><span id="local-6989586621679075418"><span class="annot"><a href="Effectful.Internal.Monad.html#withEffToIO"><span class="hs-identifier hs-type">withEffToIO</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075416"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#UnliftStrategy"><span class="hs-identifier hs-type">UnliftStrategy</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075417"><span class="annot"><a href="#local-6989586621679075417"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075416"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075417"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075417"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Continuation with the unlifting function in scope.</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075416"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075418"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-203"></span><span id="withEffToIO"><span class="annot"><span class="annottext">withEffToIO :: forall (es :: [Effect]) a.
(HasCallStack, IOE :&gt; es) =&gt;
UnliftStrategy
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#withEffToIO"><span class="hs-identifier hs-var hs-var">withEffToIO</span></a></span></span><span> </span><span id="local-6989586621679075884"><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="#local-6989586621679075884"><span class="hs-identifier hs-var">strategy</span></a></span></span><span> </span><span id="local-6989586621679075885"><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075885"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="#local-6989586621679075884"><span class="hs-identifier hs-var">strategy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="Effectful.Internal.Unlift.html#SeqUnlift"><span class="hs-identifier hs-var">SeqUnlift</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075886"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075886"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; IO a
forall (es :: [Effect]) a.
HasCallStack =&gt;
Env es -&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#seqUnliftIO"><span class="hs-identifier hs-var">seqUnliftIO</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075886"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075885"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="Effectful.Internal.Unlift.html#ConcUnlift"><span class="hs-identifier hs-type">ConcUnlift</span></a></span><span> </span><span id="local-6989586621679075888"><span class="annot"><span class="annottext">Persistence
</span><a href="#local-6989586621679075888"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679075889"><span class="annot"><span class="annottext">Limit
</span><a href="#local-6989586621679075889"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075890"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075890"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es
-&gt; Persistence
-&gt; Limit
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a)
-&gt; IO a
forall (es :: [Effect]) a.
HasCallStack =&gt;
Env es
-&gt; Persistence
-&gt; Limit
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a)
-&gt; IO a
</span><a href="Effectful.Internal.Monad.html#concUnliftIO"><span class="hs-identifier hs-var">concUnliftIO</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075890"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Persistence
</span><a href="#local-6989586621679075888"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Limit
</span><a href="#local-6989586621679075889"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075885"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Create an unlifting function with the 'ConcUnlift' strategy.</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- @since 2.2.2.0</span><span>
</span><span id="line-210"></span><span id="local-6989586621679075426"><span id="local-6989586621679075428"><span class="annot"><a href="Effectful.Internal.Monad.html#withConcEffToIO"><span class="hs-identifier hs-type">withConcEffToIO</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075426"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#Persistence"><span class="hs-identifier hs-type">Persistence</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#Limit"><span class="hs-identifier hs-type">Limit</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075427"><span class="annot"><a href="#local-6989586621679075427"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075426"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075427"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075427"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075428"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Continuation with the unlifting function in scope.</span></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075426"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075428"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-217"></span><span id="withConcEffToIO"><span class="annot"><span class="annottext">withConcEffToIO :: forall (es :: [Effect]) a.
(HasCallStack, IOE :&gt; es) =&gt;
Persistence
-&gt; Limit -&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#withConcEffToIO"><span class="hs-identifier hs-var hs-var">withConcEffToIO</span></a></span></span><span> </span><span id="local-6989586621679075895"><span class="annot"><span class="annottext">Persistence
</span><a href="#local-6989586621679075895"><span class="hs-identifier hs-var">persistence</span></a></span></span><span> </span><span id="local-6989586621679075896"><span class="annot"><span class="annottext">Limit
</span><a href="#local-6989586621679075896"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span id="local-6989586621679075897"><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075897"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075898"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075898"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="annottext">Env es
-&gt; Persistence
-&gt; Limit
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a)
-&gt; IO a
forall (es :: [Effect]) a.
HasCallStack =&gt;
Env es
-&gt; Persistence
-&gt; Limit
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a)
-&gt; IO a
</span><a href="Effectful.Internal.Monad.html#concUnliftIO"><span class="hs-identifier hs-var">concUnliftIO</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075898"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Persistence
</span><a href="#local-6989586621679075895"><span class="hs-identifier hs-var">persistence</span></a></span><span> </span><span class="annot"><span class="annottext">Limit
</span><a href="#local-6989586621679075896"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075897"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-219"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">withConcEffToIO</span><span> </span><span class="hs-pragma">&quot;Use withEffToIO with the appropriate strategy.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><span class="hs-comment">-- | Create an unlifting function with the 'SeqUnlift' strategy.</span></span><span>
</span><span id="line-222"></span><span id="local-6989586621679075413"><span id="local-6989586621679075415"><span class="annot"><a href="Effectful.Internal.Monad.html#seqUnliftIO"><span class="hs-identifier hs-type">seqUnliftIO</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075413"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The environment.</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075414"><span class="annot"><a href="#local-6989586621679075414"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075413"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075414"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075414"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075415"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Continuation with the unlifting function in scope.</span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075415"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-229"></span><span id="seqUnliftIO"><span class="annot"><span class="annottext">seqUnliftIO :: forall (es :: [Effect]) a.
HasCallStack =&gt;
Env es -&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#seqUnliftIO"><span class="hs-identifier hs-var hs-var">seqUnliftIO</span></a></span></span><span> </span><span id="local-6989586621679075902"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075902"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679075903"><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075903"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((forall r. Eff es r -&gt; IO r) -&gt; IO a)
-&gt; Env es -&gt; (forall r. Eff es r -&gt; Env es -&gt; IO r) -&gt; IO a
forall (m :: Type -&gt; Type) a (es :: [Effect]).
HasCallStack =&gt;
((forall r. m r -&gt; IO r) -&gt; IO a)
-&gt; Env es -&gt; (forall r. m r -&gt; Env es -&gt; IO r) -&gt; IO a
</span><a href="Effectful.Internal.Unlift.html#seqUnlift"><span class="hs-identifier hs-var">seqUnlift</span></a></span><span> </span><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075903"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075902"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es r -&gt; Env es -&gt; IO r
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
forall r. Eff es r -&gt; Env es -&gt; IO r
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><span class="hs-comment">-- | Create an unlifting function with the 'ConcUnlift' strategy.</span></span><span>
</span><span id="line-232"></span><span id="local-6989586621679075423"><span id="local-6989586621679075425"><span class="annot"><a href="Effectful.Internal.Monad.html#concUnliftIO"><span class="hs-identifier hs-type">concUnliftIO</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075423"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The environment.</span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#Persistence"><span class="hs-identifier hs-type">Persistence</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#Limit"><span class="hs-identifier hs-type">Limit</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075424"><span class="annot"><a href="#local-6989586621679075424"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075423"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075424"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075424"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075425"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Continuation with the unlifting function in scope.</span></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075425"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-241"></span><span id="concUnliftIO"><span class="annot"><span class="annottext">concUnliftIO :: forall (es :: [Effect]) a.
HasCallStack =&gt;
Env es
-&gt; Persistence
-&gt; Limit
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a)
-&gt; IO a
</span><a href="Effectful.Internal.Monad.html#concUnliftIO"><span class="hs-identifier hs-var hs-var">concUnliftIO</span></a></span></span><span> </span><span id="local-6989586621679075908"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075908"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679075909"><span class="annot"><span class="annottext">Persistence
</span><a href="#local-6989586621679075909"><span class="hs-identifier hs-var">persistence</span></a></span></span><span> </span><span id="local-6989586621679075910"><span class="annot"><span class="annottext">Limit
</span><a href="#local-6989586621679075910"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span id="local-6989586621679075911"><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075911"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Persistence
-&gt; Limit
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a)
-&gt; Env es
-&gt; (forall r. Eff es r -&gt; Env es -&gt; IO r)
-&gt; IO a
forall (m :: Type -&gt; Type) a (es :: [Effect]).
HasCallStack =&gt;
Persistence
-&gt; Limit
-&gt; ((forall r. m r -&gt; IO r) -&gt; IO a)
-&gt; Env es
-&gt; (forall r. m r -&gt; Env es -&gt; IO r)
-&gt; IO a
</span><a href="Effectful.Internal.Unlift.html#concUnlift"><span class="hs-identifier hs-var">concUnlift</span></a></span><span> </span><span class="annot"><span class="annottext">Persistence
</span><a href="#local-6989586621679075909"><span class="hs-identifier hs-var">persistence</span></a></span><span> </span><span class="annot"><span class="annottext">Limit
</span><a href="#local-6989586621679075910"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
</span><a href="#local-6989586621679075911"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075908"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es r -&gt; Env es -&gt; IO r
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
forall r. Eff es r -&gt; Env es -&gt; IO r
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- Base</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075453"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075453"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679075919"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Eff es a -&gt; Eff es b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679075920"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679075920"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075921"><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075921"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO b) -&gt; Eff es b
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO b) -&gt; Eff es b) -&gt; (Env es -&gt; IO b) -&gt; Eff es b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075922"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075922"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679075920"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075921"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075922"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679075925"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075925"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679075926"><span class="annot"><span class="annottext">&lt;$ :: forall a b. a -&gt; Eff es b -&gt; Eff es a
</span><a href="#local-6989586621679075926"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;$</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075928"><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075928"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075929"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075929"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075925"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO b -&gt; IO a
forall a b. a -&gt; IO b -&gt; IO a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075928"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075929"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075390"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075390"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621679075940"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Eff es a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; Eff es a
forall a (es :: [Effect]). IO a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-var">unsafeEff_</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; Eff es a) -&gt; (a -&gt; IO a) -&gt; a -&gt; Eff es a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075943"><span class="annot"><span class="annottext">Env es -&gt; IO (a -&gt; b)
</span><a href="#local-6989586621679075943"><span class="hs-identifier hs-var">mf</span></a></span></span><span> </span><span id="local-6989586621679075944"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. Eff es (a -&gt; b) -&gt; Eff es a -&gt; Eff es b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075945"><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075945"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO b) -&gt; Eff es b
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO b) -&gt; Eff es b) -&gt; (Env es -&gt; IO b) -&gt; Eff es b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075946"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075946"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO (a -&gt; b)
</span><a href="#local-6989586621679075943"><span class="hs-identifier hs-var">mf</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075946"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">IO (a -&gt; b) -&gt; IO a -&gt; IO b
forall a b. IO (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075945"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075946"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075948"><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075948"><span class="hs-identifier hs-var">ma</span></a></span></span><span>  </span><span id="local-6989586621679075949"><span class="annot"><span class="annottext">*&gt; :: forall a b. Eff es a -&gt; Eff es b -&gt; Eff es b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">*&gt;</span></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075950"><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075950"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO b) -&gt; Eff es b
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO b) -&gt; Eff es b) -&gt; (Env es -&gt; IO b) -&gt; Eff es b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075951"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075951"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075948"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075951"><span class="hs-identifier hs-var">es</span></a></span><span>  </span><span class="annot"><span class="annottext">IO a -&gt; IO b -&gt; IO b
forall a b. IO a -&gt; IO b -&gt; IO b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075950"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075951"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075953"><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075953"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679075954"><span class="annot"><span class="annottext">&lt;* :: forall a b. Eff es a -&gt; Eff es b -&gt; Eff es a
</span><a href="#local-6989586621679075954"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*</span></a></span></span><span>  </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075956"><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075956"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075957"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075957"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075953"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075957"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO b -&gt; IO a
forall a b. IO a -&gt; IO b -&gt; IO a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span>  </span><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075956"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075957"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679075959"><span class="annot"><span class="annottext">liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Eff es a -&gt; Eff es b -&gt; Eff es c
</span><a href="#local-6989586621679075959"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftA2</span></a></span></span><span> </span><span id="local-6989586621679075961"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679075961"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075962"><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075962"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075963"><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075963"><span class="hs-identifier hs-var">mb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO c) -&gt; Eff es c
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO c) -&gt; Eff es c) -&gt; (Env es -&gt; IO c) -&gt; Eff es c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075964"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075964"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; c) -&gt; IO a -&gt; IO b -&gt; IO c
forall a b c. (a -&gt; b -&gt; c) -&gt; IO a -&gt; IO b -&gt; IO c
forall (f :: Type -&gt; Type) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679075961"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075962"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075964"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075963"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075964"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075389"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075389"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679075972"><span class="annot"><span class="annottext">return :: forall a. a -&gt; Eff es a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; Eff es a
forall a (es :: [Effect]). IO a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-var">unsafeEff_</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; Eff es a) -&gt; (a -&gt; IO a) -&gt; a -&gt; Eff es a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075974"><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075974"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679075975"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. Eff es a -&gt; (a -&gt; Eff es b) -&gt; Eff es b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679075976"><span class="annot"><span class="annottext">a -&gt; Eff es b
</span><a href="#local-6989586621679075976"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO b) -&gt; Eff es b
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO b) -&gt; Eff es b) -&gt; (Env es -&gt; IO b) -&gt; Eff es b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075977"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075977"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075974"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075977"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075978"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075978"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff es b -&gt; Env es -&gt; IO b
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Eff es b
</span><a href="#local-6989586621679075976"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075978"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075977"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-comment">-- https://gitlab.haskell.org/ghc/ghc/-/issues/20008</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075980"><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075980"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679075981"><span class="annot"><span class="annottext">&gt;&gt; :: forall a b. Eff es a -&gt; Eff es b -&gt; Eff es b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;</span></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span id="local-6989586621679075982"><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075982"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO b) -&gt; Eff es b
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO b) -&gt; Eff es b) -&gt; (Env es -&gt; IO b) -&gt; Eff es b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075983"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075983"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO a
</span><a href="#local-6989586621679075980"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075983"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO b -&gt; IO b
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO b
</span><a href="#local-6989586621679075982"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075983"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075499"><span class="annot"><span class="hs-identifier hs-type">MonadFix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075499"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679075991"><span class="annot"><span class="annottext">mfix :: forall a. (a -&gt; Eff es a) -&gt; Eff es a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mfix</span></span></span><span> </span><span id="local-6989586621679075992"><span class="annot"><span class="annottext">a -&gt; Eff es a
</span><a href="#local-6989586621679075992"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075993"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075993"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; IO a) -&gt; IO a
forall a. (a -&gt; IO a) -&gt; IO a
forall (m :: Type -&gt; Type) a. MonadFix m =&gt; (a -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">mfix</span></span><span> </span><span class="annot"><span class="annottext">((a -&gt; IO a) -&gt; IO a) -&gt; (a -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679075994"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075994"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Eff es a
</span><a href="#local-6989586621679075992"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075994"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679075993"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- NonDet</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Provide the ability to use the 'Alternative' and 'MonadPlus' instance for</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- 'Eff'.</span><span>
</span><span id="line-271"></span><span class="hs-comment">--</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- @since 2.2.0.0</span><span>
</span><span id="line-273"></span><span class="hs-keyword">data</span><span> </span><span id="NonDet"><span class="annot"><a href="Effectful.Internal.Monad.html#NonDet"><span class="hs-identifier hs-var">NonDet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679075515"><span id="local-6989586621679075516"><span id="Empty"><span class="annot"><a href="Effectful.Internal.Monad.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#NonDet"><span class="hs-identifier hs-type">NonDet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075515"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075516"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679075518"><span id="local-6989586621679075519"><span id="%3A%3C%7C%3E%3A"><span class="annot"><a href="Effectful.Internal.Monad.html#%3A%3C%7C%3E%3A"><span class="hs-operator hs-var">(:&lt;|&gt;:)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679075518"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075519"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075518"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075519"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#NonDet"><span class="hs-identifier hs-type">NonDet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075518"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075519"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="DispatchOf"><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-var">DispatchOf</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#NonDet"><span class="hs-identifier hs-type">NonDet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="annot"><span class="hs-comment">-- | @since 2.2.0.0</span></span><span>
</span><span id="line-280"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075508"><span id="local-6989586621679076003"><span id="local-6989586621679076007"><span class="annot"><a href="Effectful.Internal.Monad.html#NonDet"><span class="hs-identifier hs-type">NonDet</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075508"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Alternative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075508"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679076012"><span class="annot"><span class="annottext">empty :: forall a. Eff es a
</span><a href="#local-6989586621679076012"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; Eff es a) -&gt; Eff es a
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">withFrozenCallStack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonDet (Eff es) a -&gt; Eff es a
forall (e :: Effect) (es :: [Effect]) a.
(HasCallStack, DispatchOf e ~ 'Dynamic, e :&gt; es) =&gt;
e (Eff es) a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#send"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="annot"><span class="annottext">NonDet (Eff es) a
forall (m :: Type -&gt; Type) a. NonDet m a
</span><a href="Effectful.Internal.Monad.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621679076026"><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076026"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679076027"><span class="annot"><span class="annottext">&lt;|&gt; :: forall a. Eff es a -&gt; Eff es a -&gt; Eff es a
</span><a href="#local-6989586621679076027"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;|&gt;</span></a></span></span><span> </span><span id="local-6989586621679076029"><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076029"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonDet (Eff es) a -&gt; Eff es a
forall (e :: Effect) (es :: [Effect]) a.
(HasCallStack, DispatchOf e ~ 'Dynamic, e :&gt; es) =&gt;
e (Eff es) a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#send"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076026"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es a -&gt; Eff es a -&gt; NonDet (Eff es) a
forall (m :: Type -&gt; Type) a. m a -&gt; m a -&gt; NonDet m a
</span><a href="Effectful.Internal.Monad.html#%3A%3C%7C%3E%3A"><span class="hs-operator hs-var">:&lt;|&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076029"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><span class="hs-comment">-- | @since 2.2.0.0</span></span><span>
</span><span id="line-285"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075525"><span id="local-6989586621679076036"><span id="local-6989586621679076040"><span class="annot"><a href="Effectful.Internal.Monad.html#NonDet"><span class="hs-identifier hs-type">NonDet</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075525"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075525"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- Exception</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075532"><span class="annot"><span class="hs-identifier hs-type">C.MonadThrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075532"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621679076051"><span class="annot"><span class="annottext">throwM :: forall e a. (HasCallStack, Exception e) =&gt; e -&gt; Eff es a
</span><a href="#local-6989586621679076051"><span class="hs-identifier hs-var hs-var hs-var hs-var">throwM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; Eff es a
forall a (es :: [Effect]). IO a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-var">unsafeEff_</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; Eff es a) -&gt; (e -&gt; IO a) -&gt; e -&gt; Eff es a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">E.throwIO</span></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075542"><span class="annot"><span class="hs-identifier hs-type">C.MonadCatch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075542"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679076062"><span class="annot"><span class="annottext">catch :: forall e a.
(HasCallStack, Exception e) =&gt;
Eff es a -&gt; (e -&gt; Eff es a) -&gt; Eff es a
</span><a href="#local-6989586621679076062"><span class="hs-identifier hs-var hs-var hs-var hs-var">catch</span></a></span></span><span> </span><span id="local-6989586621679076064"><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076064"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679076065"><span class="annot"><span class="annottext">e -&gt; Eff es a
</span><a href="#local-6989586621679076065"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076066"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076066"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076064"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076066"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; (e -&gt; IO a) -&gt; IO a
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`E.catch`</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076068"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679076068"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; Eff es a
</span><a href="#local-6989586621679076065"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679076068"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076066"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075556"><span class="annot"><span class="hs-identifier hs-type">C.MonadMask</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075556"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621679076077"><span class="annot"><span class="annottext">mask :: forall b.
HasCallStack =&gt;
((forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b) -&gt; Eff es b
</span><a href="#local-6989586621679076077"><span class="hs-identifier hs-var hs-var hs-var hs-var">mask</span></a></span></span><span> </span><span id="local-6989586621679076079"><span class="annot"><span class="annottext">(forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b
</span><a href="#local-6989586621679076079"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO b) -&gt; Eff es b
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO b) -&gt; Eff es b) -&gt; (Env es -&gt; IO b) -&gt; Eff es b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076080"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076080"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b
forall b. ((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">E.mask</span></span><span> </span><span class="annot"><span class="annottext">(((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b)
-&gt; ((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076082"><span class="annot"><span class="annottext">forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679076082"><span class="hs-identifier hs-var">unmask</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><span class="annottext">Eff es b -&gt; Env es -&gt; IO b
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b
</span><a href="#local-6989586621679076079"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">((forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b)
-&gt; (forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076083"><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076083"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO a
forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679076082"><span class="hs-identifier hs-var">unmask</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; IO a) -&gt; (Env es -&gt; IO a) -&gt; Env es -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076083"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076080"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679076085"><span class="annot"><span class="annottext">uninterruptibleMask :: forall b.
HasCallStack =&gt;
((forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b) -&gt; Eff es b
</span><a href="#local-6989586621679076085"><span class="hs-identifier hs-var hs-var hs-var hs-var">uninterruptibleMask</span></a></span></span><span> </span><span id="local-6989586621679076087"><span class="annot"><span class="annottext">(forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b
</span><a href="#local-6989586621679076087"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO b) -&gt; Eff es b
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO b) -&gt; Eff es b) -&gt; (Env es -&gt; IO b) -&gt; Eff es b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076088"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076088"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b
forall b. ((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">E.uninterruptibleMask</span></span><span> </span><span class="annot"><span class="annottext">(((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b)
-&gt; ((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076090"><span class="annot"><span class="annottext">forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679076090"><span class="hs-identifier hs-var">unmask</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="annottext">Eff es b -&gt; Env es -&gt; IO b
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b
</span><a href="#local-6989586621679076087"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">((forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b)
-&gt; (forall a. Eff es a -&gt; Eff es a) -&gt; Eff es b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076091"><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076091"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO a
forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679076090"><span class="hs-identifier hs-var">unmask</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; IO a) -&gt; (Env es -&gt; IO a) -&gt; Env es -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076091"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076088"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621679076101"><span class="annot"><span class="annottext">generalBracket :: forall a b c.
HasCallStack =&gt;
Eff es a
-&gt; (a -&gt; ExitCase b -&gt; Eff es c)
-&gt; (a -&gt; Eff es b)
-&gt; Eff es (b, c)
</span><a href="#local-6989586621679076101"><span class="hs-identifier hs-var hs-var hs-var hs-var">generalBracket</span></a></span></span><span> </span><span id="local-6989586621679076103"><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076103"><span class="hs-identifier hs-var">acquire</span></a></span></span><span> </span><span id="local-6989586621679076104"><span class="annot"><span class="annottext">a -&gt; ExitCase b -&gt; Eff es c
</span><a href="#local-6989586621679076104"><span class="hs-identifier hs-var">release</span></a></span></span><span> </span><span id="local-6989586621679076105"><span class="annot"><span class="annottext">a -&gt; Eff es b
</span><a href="#local-6989586621679076105"><span class="hs-identifier hs-var">use</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO (b, c)) -&gt; Eff es (b, c)
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO (b, c)) -&gt; Eff es (b, c))
-&gt; (Env es -&gt; IO (b, c)) -&gt; Eff es (b, c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076106"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076106"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((forall a. IO a -&gt; IO a) -&gt; IO (b, c)) -&gt; IO (b, c)
forall b. ((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">E.mask</span></span><span> </span><span class="annot"><span class="annottext">(((forall a. IO a -&gt; IO a) -&gt; IO (b, c)) -&gt; IO (b, c))
-&gt; ((forall a. IO a -&gt; IO a) -&gt; IO (b, c)) -&gt; IO (b, c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076107"><span class="annot"><span class="annottext">forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679076107"><span class="hs-identifier hs-var">unmask</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679076108"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679076108"><span class="hs-identifier hs-var">resource</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076103"><span class="hs-identifier hs-var">acquire</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076106"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679076109"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679076109"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO b -&gt; IO b
forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679076107"><span class="hs-identifier hs-var">unmask</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eff es b -&gt; Env es -&gt; IO b
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Eff es b
</span><a href="#local-6989586621679076105"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679076108"><span class="hs-identifier hs-var">resource</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076106"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO b -&gt; (SomeException -&gt; IO b) -&gt; IO b
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`E.catch`</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076110"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679076110"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>      </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff es c -&gt; Env es -&gt; IO c
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ExitCase b -&gt; Eff es c
</span><a href="#local-6989586621679076104"><span class="hs-identifier hs-var">release</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679076108"><span class="hs-identifier hs-var">resource</span></a></span><span> </span><span class="annot"><span class="annottext">(ExitCase b -&gt; Eff es c) -&gt; ExitCase b -&gt; Eff es c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; ExitCase b
forall a. SomeException -&gt; ExitCase a
</span><span class="hs-identifier hs-var">C.ExitCaseException</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679076110"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076106"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">SomeException -&gt; IO b
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">E.throwIO</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679076110"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679076112"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679076112"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff es c -&gt; Env es -&gt; IO c
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ExitCase b -&gt; Eff es c
</span><a href="#local-6989586621679076104"><span class="hs-identifier hs-var">release</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679076108"><span class="hs-identifier hs-var">resource</span></a></span><span> </span><span class="annot"><span class="annottext">(ExitCase b -&gt; Eff es c) -&gt; ExitCase b -&gt; Eff es c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; ExitCase b
forall a. a -&gt; ExitCase a
</span><span class="hs-identifier hs-var">C.ExitCaseSuccess</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679076109"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076106"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">(b, c) -&gt; IO (b, c)
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679076109"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679076112"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- Fail</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><span class="hs-comment">-- | Provide the ability to use the 'MonadFail' instance for 'Eff'.</span></span><span>
</span><span id="line-317"></span><span class="hs-keyword">data</span><span> </span><span id="Fail"><span class="annot"><a href="Effectful.Internal.Monad.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621679075574"><span id="local-6989586621679075575"><span id="Fail"><span class="annot"><a href="Effectful.Internal.Monad.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Fail"><span class="hs-identifier hs-type">Fail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075574"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075575"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="DispatchOf"><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-var">DispatchOf</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Fail"><span class="hs-identifier hs-type">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075572"><span class="annot"><a href="Effectful.Internal.Monad.html#Fail"><span class="hs-identifier hs-type">Fail</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075572"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075572"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621679076123"><span class="annot"><span class="annottext">fail :: forall a. String -&gt; Eff es a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fail</span></span></span><span> </span><span id="local-6989586621679076124"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076124"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HasCallStack =&gt; Eff es a) -&gt; Eff es a
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">withFrozenCallStack</span></span><span> </span><span class="annot"><span class="annottext">((HasCallStack =&gt; Eff es a) -&gt; Eff es a)
-&gt; (HasCallStack =&gt; Eff es a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Fail (Eff es) a -&gt; Eff es a
forall (e :: Effect) (es :: [Effect]) a.
(HasCallStack, DispatchOf e ~ 'Dynamic, e :&gt; es) =&gt;
e (Eff es) a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#send"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Fail (Eff es) a
forall (m :: Type -&gt; Type) a. String -&gt; Fail m a
</span><a href="Effectful.Internal.Monad.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679076124"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- IO</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- | Run arbitrary 'IO' computations via 'MonadIO' or 'MonadUnliftIO'.</span><span>
</span><span id="line-329"></span><span class="hs-comment">--</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- /Note:/ it is not recommended to use this effect in application code as it is</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- too liberal. Ideally, this is only used in handlers of more fine-grained</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- effects.</span><span>
</span><span id="line-333"></span><span class="hs-keyword">data</span><span> </span><span id="IOE"><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-var">IOE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="DispatchOf"><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-var">DispatchOf</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#WithSideEffects"><span class="hs-identifier hs-type">WithSideEffects</span></a></span><span>
</span><span id="line-336"></span><span class="hs-keyword">newtype</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="StaticRep"><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-var">StaticRep</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IOE"><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-var">IOE</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#UnliftStrategy"><span class="hs-identifier hs-type">UnliftStrategy</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-comment">-- | Run an 'Eff' computation with side effects.</span><span>
</span><span id="line-339"></span><span class="hs-comment">--</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- For running pure computations see 'runPureEff'.</span><span>
</span><span id="line-341"></span><span id="local-6989586621679075576"><span class="annot"><a href="Effectful.Internal.Monad.html#runEff"><span class="hs-identifier hs-type">runEff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679075576"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679075576"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-342"></span><span id="runEff"><span class="annot"><span class="annottext">runEff :: forall a. Eff '[IOE] a -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#runEff"><span class="hs-identifier hs-var hs-var">runEff</span></a></span></span><span> </span><span id="local-6989586621679076133"><span class="annot"><span class="annottext">Eff '[IOE] a
</span><a href="#local-6989586621679076133"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff '[IOE] a -&gt; Env '[IOE] -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[IOE] a
</span><a href="#local-6989586621679076133"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Env '[IOE] -&gt; IO a) -&gt; IO (Env '[IOE]) -&gt; IO a
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">EffectRep (DispatchOf IOE) IOE
-&gt; Relinker (EffectRep (DispatchOf IOE)) IOE
-&gt; Env '[]
-&gt; IO (Env '[IOE])
forall (e :: Effect) (es :: [Effect]).
EffectRep (DispatchOf e) e
-&gt; Relinker (EffectRep (DispatchOf e)) e
-&gt; Env es
-&gt; IO (Env (e : es))
</span><a href="Effectful.Internal.Env.html#consEnv"><span class="hs-identifier hs-var">consEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnliftStrategy -&gt; StaticRep IOE
</span><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-var">IOE</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="Effectful.Internal.Unlift.html#SeqUnlift"><span class="hs-identifier hs-var">SeqUnlift</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Relinker (EffectRep (DispatchOf IOE)) IOE
Relinker StaticRep IOE
forall (rep :: Effect -&gt; Type) (e :: Effect). Relinker rep e
</span><a href="Effectful.Internal.Env.html#dummyRelinker"><span class="hs-identifier hs-var">dummyRelinker</span></a></span><span> </span><span class="annot"><span class="annottext">(Env '[] -&gt; IO (Env '[IOE])) -&gt; IO (Env '[]) -&gt; IO (Env '[IOE])
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Env '[])
</span><a href="Effectful.Internal.Env.html#emptyEnv"><span class="hs-identifier hs-var">emptyEnv</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075588"><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075588"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075588"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621679076141"><span class="annot"><span class="annottext">liftIO :: forall a. IO a -&gt; Eff es a
</span><a href="#local-6989586621679076141"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; Eff es a
forall a (es :: [Effect]). IO a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-var">unsafeEff_</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">-- | Instance included for compatibility with existing code.</span><span>
</span><span id="line-348"></span><span class="hs-comment">--</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- Usage of 'withEffToIO' is preferrable as it allows specifying the</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- 'UnliftStrategy' on a case-by-case basis and has better error reporting.</span><span>
</span><span id="line-351"></span><span class="hs-comment">--</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- /Note:/ the unlifting strategy for 'withRunInIO' is taken from the 'IOE'</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- context (see 'unliftStrategy').</span><span>
</span><span id="line-354"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075595"><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075595"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadUnliftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075595"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679076155"><span class="annot"><span class="annottext">withRunInIO :: forall b. ((forall a. Eff es a -&gt; IO a) -&gt; IO b) -&gt; Eff es b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">withRunInIO</span></span></span><span> </span><span id="local-6989586621679076156"><span class="annot"><span class="annottext">(forall a. Eff es a -&gt; IO a) -&gt; IO b
</span><a href="#local-6989586621679076156"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff es UnliftStrategy
forall (es :: [Effect]). (IOE :&gt; es) =&gt; Eff es UnliftStrategy
</span><a href="Effectful.Internal.Monad.html#unliftStrategy"><span class="hs-identifier hs-var">unliftStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es UnliftStrategy -&gt; (UnliftStrategy -&gt; Eff es b) -&gt; Eff es b
forall a b. Eff es a -&gt; (a -&gt; Eff es b) -&gt; Eff es b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnliftStrategy
-&gt; ((forall a. Eff es a -&gt; IO a) -&gt; IO b) -&gt; Eff es b
forall (es :: [Effect]) a.
(HasCallStack, IOE :&gt; es) =&gt;
UnliftStrategy
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#withEffToIO"><span class="hs-operator hs-var">`withEffToIO`</span></a></span><span> </span><span class="annot"><span class="annottext">(forall a. Eff es a -&gt; IO a) -&gt; IO b
</span><a href="#local-6989586621679076156"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- | Instance included for compatibility with existing code.</span><span>
</span><span id="line-358"></span><span class="hs-comment">--</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- Usage of 'liftIO' is preferrable as it's a standard.</span><span>
</span><span id="line-360"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075602"><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075602"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBase</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075602"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-361"></span><span>  </span><span id="local-6989586621679076169"><span class="annot"><span class="annottext">liftBase :: forall &#945;. IO &#945; -&gt; Eff es &#945;
</span><a href="#local-6989586621679076169"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftBase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO &#945; -&gt; Eff es &#945;
forall a (es :: [Effect]). IO a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-var">unsafeEff_</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Instance included for compatibility with existing code.</span><span>
</span><span id="line-364"></span><span class="hs-comment">--</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- Usage of 'withEffToIO' is preferrable as it allows specifying the</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- 'UnliftStrategy' on a case-by-case basis and has better error reporting.</span><span>
</span><span id="line-367"></span><span class="hs-comment">--</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- /Note:/ the unlifting strategy for 'liftBaseWith' is taken from the 'IOE'</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- context (see 'unliftStrategy').</span><span>
</span><span id="line-370"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075612"><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075612"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075612"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StM"><span class="annot"><span class="hs-identifier hs-var">StM</span></span></span><span> </span><span id="local-6989586621679076179"><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075612"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679076179"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679076179"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621679076185"><span class="annot"><span class="annottext">liftBaseWith :: forall a. (RunInBase (Eff es) IO -&gt; IO a) -&gt; Eff es a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">liftBaseWith</span></span></span><span> </span><span id="local-6989586621679076186"><span class="annot"><span class="annottext">RunInBase (Eff es) IO -&gt; IO a
</span><a href="#local-6989586621679076186"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff es UnliftStrategy
forall (es :: [Effect]). (IOE :&gt; es) =&gt; Eff es UnliftStrategy
</span><a href="Effectful.Internal.Monad.html#unliftStrategy"><span class="hs-identifier hs-var">unliftStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es UnliftStrategy -&gt; (UnliftStrategy -&gt; Eff es a) -&gt; Eff es a
forall a b. Eff es a -&gt; (a -&gt; Eff es b) -&gt; Eff es b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnliftStrategy
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a.
(HasCallStack, IOE :&gt; es) =&gt;
UnliftStrategy
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#withEffToIO"><span class="hs-operator hs-var">`withEffToIO`</span></a></span><span> </span><span class="annot"><span class="annottext">(forall r. Eff es r -&gt; IO r) -&gt; IO a
RunInBase (Eff es) IO -&gt; IO a
</span><a href="#local-6989586621679076186"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679076188"><span class="annot"><span class="annottext">restoreM :: forall a. StM (Eff es) a -&gt; Eff es a
</span><a href="#local-6989586621679076188"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Eff es a
StM (Eff es) a -&gt; Eff es a
forall a. a -&gt; Eff es a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- Primitive</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="annot"><span class="hs-comment">-- | Provide the ability to perform primitive state-transformer actions.</span></span><span>
</span><span id="line-379"></span><span class="hs-keyword">data</span><span> </span><span id="Prim"><span class="annot"><a href="Effectful.Internal.Monad.html#Prim"><span class="hs-identifier hs-var">Prim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="DispatchOf"><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-var">DispatchOf</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#WithSideEffects"><span class="hs-identifier hs-type">WithSideEffects</span></a></span><span>
</span><span id="line-382"></span><span class="hs-keyword">data</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="StaticRep"><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-var">StaticRep</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Prim"><span class="annot"><a href="Effectful.Internal.Monad.html#Prim"><span class="hs-identifier hs-var">Prim</span></a></span></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- | 'PrimState' token for 'Eff'. Used instead of 'RealWorld' to prevent the</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- 'Prim' effect from executing arbitrary 'IO' actions via 'ioToPrim'.</span><span>
</span><span id="line-386"></span><span class="hs-keyword">data</span><span> </span><span id="PrimStateEff"><span class="annot"><a href="Effectful.Internal.Monad.html#PrimStateEff"><span class="hs-identifier hs-var">PrimStateEff</span></a></span></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><span class="hs-comment">-- | Run an 'Eff' computation with primitive state-transformer actions.</span></span><span>
</span><span id="line-389"></span><span id="local-6989586621679075615"><span id="local-6989586621679075617"><span class="annot"><a href="Effectful.Internal.Monad.html#runPrim"><span class="hs-identifier hs-type">runPrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075615"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679075615"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075617"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075615"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075617"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-390"></span><span id="runPrim"><span class="annot"><span class="annottext">runPrim :: forall (es :: [Effect]) a.
(IOE :&gt; es) =&gt;
Eff (Prim : es) a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#runPrim"><span class="hs-identifier hs-var hs-var">runPrim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StaticRep Prim -&gt; Eff (Prim : es) a -&gt; Eff es a
forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect])
       a.
(DispatchOf e ~ 'Static sideEffects, MaybeIOE sideEffects es) =&gt;
StaticRep e -&gt; Eff (e : es) a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#evalStaticRep"><span class="hs-identifier hs-var">evalStaticRep</span></a></span><span> </span><span class="annot"><span class="annottext">StaticRep Prim
</span><a href="Effectful.Internal.Monad.html#Prim"><span class="hs-identifier hs-var">Prim</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075630"><span class="annot"><a href="Effectful.Internal.Monad.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075630"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075630"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PrimState"><span class="annot"><span class="hs-identifier hs-var">PrimState</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075630"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#PrimStateEff"><span class="hs-identifier hs-type">PrimStateEff</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621679076202"><span class="annot"><span class="annottext">primitive :: forall a.
(State# (PrimState (Eff es))
 -&gt; (# State# (PrimState (Eff es)), a #))
-&gt; Eff es a
</span><a href="#local-6989586621679076202"><span class="hs-identifier hs-var hs-var hs-var hs-var">primitive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; Eff es a
forall a (es :: [Effect]). IO a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-var">unsafeEff_</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; Eff es a)
-&gt; ((State# PrimStateEff -&gt; (# State# PrimStateEff, a #)) -&gt; IO a)
-&gt; (State# PrimStateEff -&gt; (# State# PrimStateEff, a #))
-&gt; Eff es a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(State# RealWorld -&gt; (# State# RealWorld, a #)) -&gt; IO a
forall a. (State# RealWorld -&gt; (# State# RealWorld, a #)) -&gt; IO a
</span><span class="hs-identifier hs-var">IO</span></span><span> </span><span class="annot"><span class="annottext">((State# RealWorld -&gt; (# State# RealWorld, a #)) -&gt; IO a)
-&gt; ((State# PrimStateEff -&gt; (# State# PrimStateEff, a #))
    -&gt; State# RealWorld -&gt; (# State# RealWorld, a #))
-&gt; (State# PrimStateEff -&gt; (# State# PrimStateEff, a #))
-&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(State# PrimStateEff -&gt; (# State# PrimStateEff, a #))
-&gt; State# RealWorld -&gt; (# State# RealWorld, a #)
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- Lifting</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="annot"><span class="hs-comment">-- | Lift an 'Eff' computation into an effect stack with one more effect.</span></span><span>
</span><span id="line-400"></span><span id="local-6989586621679075636"><span id="local-6989586621679075637"><span id="local-6989586621679075638"><span class="annot"><a href="Effectful.Internal.Monad.html#raise"><span class="hs-identifier hs-type">raise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075636"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075637"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075638"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679075636"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075637"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-401"></span><span id="raise"><span class="annot"><span class="annottext">raise :: forall (es :: [Effect]) a (e :: Effect). Eff es a -&gt; Eff (e : es) a
</span><a href="Effectful.Internal.Monad.html#raise"><span class="hs-identifier hs-var hs-var">raise</span></a></span></span><span> </span><span id="local-6989586621679076205"><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076205"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env (e : es) -&gt; IO a) -&gt; Eff (e : es) a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env (e : es) -&gt; IO a) -&gt; Eff (e : es) a)
-&gt; (Env (e : es) -&gt; IO a) -&gt; Eff (e : es) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076206"><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076206"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076205"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; IO (Env es) -&gt; IO a
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Env (e : es) -&gt; IO (Env es)
forall (e :: Effect) (es :: [Effect]). Env (e : es) -&gt; IO (Env es)
</span><a href="Effectful.Internal.Env.html#tailEnv"><span class="hs-identifier hs-var">tailEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076206"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- | Lift an 'Eff' computation into an effect stack with one more effect and</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- create an unlifting function with the given strategy.</span><span>
</span><span id="line-405"></span><span class="hs-comment">--</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- @since 1.2.0.0</span><span>
</span><span id="line-407"></span><span id="local-6989586621679075644"><span id="local-6989586621679075645"><span id="local-6989586621679075647"><span class="annot"><a href="Effectful.Internal.Monad.html#raiseWith"><span class="hs-identifier hs-type">raiseWith</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Unlift.html#UnliftStrategy"><span class="hs-identifier hs-type">UnliftStrategy</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075646"><span class="annot"><a href="#local-6989586621679075646"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075644"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679075645"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075646"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075645"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075646"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075645"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075647"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Continuation with the unlifting function in scope.</span></span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075644"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679075645"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075647"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-413"></span><span id="raiseWith"><span class="annot"><span class="annottext">raiseWith :: forall (e :: Effect) (es :: [Effect]) a.
HasCallStack =&gt;
UnliftStrategy
-&gt; ((forall r. Eff (e : es) r -&gt; Eff es r) -&gt; Eff es a)
-&gt; Eff (e : es) a
</span><a href="Effectful.Internal.Monad.html#raiseWith"><span class="hs-identifier hs-var hs-var">raiseWith</span></a></span></span><span> </span><span id="local-6989586621679076215"><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="#local-6989586621679076215"><span class="hs-identifier hs-var">strategy</span></a></span></span><span> </span><span id="local-6989586621679076216"><span class="annot"><span class="annottext">(forall r. Eff (e : es) r -&gt; Eff es r) -&gt; Eff es a
</span><a href="#local-6989586621679076216"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="#local-6989586621679076215"><span class="hs-identifier hs-var">strategy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><span class="annottext">UnliftStrategy
</span><a href="Effectful.Internal.Unlift.html#SeqUnlift"><span class="hs-identifier hs-var">SeqUnlift</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Env (e : es) -&gt; IO a) -&gt; Eff (e : es) a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env (e : es) -&gt; IO a) -&gt; Eff (e : es) a)
-&gt; (Env (e : es) -&gt; IO a) -&gt; Eff (e : es) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076217"><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076217"><span class="hs-identifier hs-var">ees</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-415"></span><span>    </span><span id="local-6989586621679076218"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076218"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env (e : es) -&gt; IO (Env es)
forall (e :: Effect) (es :: [Effect]). Env (e : es) -&gt; IO (Env es)
</span><a href="Effectful.Internal.Env.html#tailEnv"><span class="hs-identifier hs-var">tailEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076217"><span class="hs-identifier hs-var">ees</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><span class="annottext">Env (e : es)
-&gt; ((forall r. Eff (e : es) r -&gt; IO r) -&gt; IO a) -&gt; IO a
forall (es :: [Effect]) a.
HasCallStack =&gt;
Env es -&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a) -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#seqUnliftIO"><span class="hs-identifier hs-var">seqUnliftIO</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076217"><span class="hs-identifier hs-var">ees</span></a></span><span> </span><span class="annot"><span class="annottext">(((forall r. Eff (e : es) r -&gt; IO r) -&gt; IO a) -&gt; IO a)
-&gt; ((forall r. Eff (e : es) r -&gt; IO r) -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076219"><span class="annot"><span class="annottext">forall r. Eff (e : es) r -&gt; IO r
</span><a href="#local-6989586621679076219"><span class="hs-identifier hs-var">unlift</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-operator hs-var">`unEff`</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076218"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff es a -&gt; IO a) -&gt; Eff es a -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall r. Eff (e : es) r -&gt; Eff es r) -&gt; Eff es a
</span><a href="#local-6989586621679076216"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r. Eff (e : es) r -&gt; Eff es r) -&gt; Eff es a)
-&gt; (forall r. Eff (e : es) r -&gt; Eff es r) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO r -&gt; Eff es r
forall a (es :: [Effect]). IO a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-var">unsafeEff_</span></a></span><span> </span><span class="annot"><span class="annottext">(IO r -&gt; Eff es r)
-&gt; (Eff (e : es) r -&gt; IO r) -&gt; Eff (e : es) r -&gt; Eff es r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Eff (e : es) r -&gt; IO r
forall r. Eff (e : es) r -&gt; IO r
</span><a href="#local-6989586621679076219"><span class="hs-identifier hs-var">unlift</span></a></span><span>
</span><span id="line-418"></span><span>  </span><span class="annot"><a href="Effectful.Internal.Unlift.html#ConcUnlift"><span class="hs-identifier hs-type">ConcUnlift</span></a></span><span> </span><span id="local-6989586621679076220"><span class="annot"><span class="annottext">Persistence
</span><a href="#local-6989586621679076220"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679076221"><span class="annot"><span class="annottext">Limit
</span><a href="#local-6989586621679076221"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Env (e : es) -&gt; IO a) -&gt; Eff (e : es) a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env (e : es) -&gt; IO a) -&gt; Eff (e : es) a)
-&gt; (Env (e : es) -&gt; IO a) -&gt; Eff (e : es) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076222"><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076222"><span class="hs-identifier hs-var">ees</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>    </span><span id="local-6989586621679076223"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076223"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env (e : es) -&gt; IO (Env es)
forall (e :: Effect) (es :: [Effect]). Env (e : es) -&gt; IO (Env es)
</span><a href="Effectful.Internal.Env.html#tailEnv"><span class="hs-identifier hs-var">tailEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076222"><span class="hs-identifier hs-var">ees</span></a></span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><span class="annottext">Env (e : es)
-&gt; Persistence
-&gt; Limit
-&gt; ((forall r. Eff (e : es) r -&gt; IO r) -&gt; IO a)
-&gt; IO a
forall (es :: [Effect]) a.
HasCallStack =&gt;
Env es
-&gt; Persistence
-&gt; Limit
-&gt; ((forall r. Eff es r -&gt; IO r) -&gt; IO a)
-&gt; IO a
</span><a href="Effectful.Internal.Monad.html#concUnliftIO"><span class="hs-identifier hs-var">concUnliftIO</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076222"><span class="hs-identifier hs-var">ees</span></a></span><span> </span><span class="annot"><span class="annottext">Persistence
</span><a href="#local-6989586621679076220"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Limit
</span><a href="#local-6989586621679076221"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(((forall r. Eff (e : es) r -&gt; IO r) -&gt; IO a) -&gt; IO a)
-&gt; ((forall r. Eff (e : es) r -&gt; IO r) -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076224"><span class="annot"><span class="annottext">forall r. Eff (e : es) r -&gt; IO r
</span><a href="#local-6989586621679076224"><span class="hs-identifier hs-var">unlift</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-421"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-operator hs-var">`unEff`</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076223"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff es a -&gt; IO a) -&gt; Eff es a -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall r. Eff (e : es) r -&gt; Eff es r) -&gt; Eff es a
</span><a href="#local-6989586621679076216"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r. Eff (e : es) r -&gt; Eff es r) -&gt; Eff es a)
-&gt; (forall r. Eff (e : es) r -&gt; Eff es r) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO r -&gt; Eff es r
forall a (es :: [Effect]). IO a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff_"><span class="hs-identifier hs-var">unsafeEff_</span></a></span><span> </span><span class="annot"><span class="annottext">(IO r -&gt; Eff es r)
-&gt; (Eff (e : es) r -&gt; IO r) -&gt; Eff (e : es) r -&gt; Eff es r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Eff (e : es) r -&gt; IO r
forall r. Eff (e : es) r -&gt; IO r
</span><a href="#local-6989586621679076224"><span class="hs-identifier hs-var">unlift</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="annot"><span class="hs-comment">-- | Eliminate a duplicate effect from the top of the effect stack.</span></span><span>
</span><span id="line-424"></span><span id="local-6989586621679075657"><span id="local-6989586621679075658"><span id="local-6989586621679075659"><span class="annot"><a href="Effectful.Internal.Monad.html#subsume"><span class="hs-identifier hs-type">subsume</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679075657"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075658"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075657"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679075658"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075659"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075658"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075659"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-425"></span><span id="subsume"><span class="annot"><span class="annottext">subsume :: forall (e :: Effect) (es :: [Effect]) a.
(e :&gt; es) =&gt;
Eff (e : es) a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#subsume"><span class="hs-identifier hs-var hs-var">subsume</span></a></span></span><span> </span><span id="local-6989586621679076228"><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076228"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076229"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076229"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a -&gt; Env (e : es) -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076228"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Env (e : es) -&gt; IO a) -&gt; IO (Env (e : es)) -&gt; IO a
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO (Env (e : es))
forall (e :: Effect) (es :: [Effect]).
(e :&gt; es) =&gt;
Env es -&gt; IO (Env (e : es))
</span><a href="Effectful.Internal.Env.html#subsumeEnv"><span class="hs-identifier hs-var">subsumeEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076229"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- | Allow for running an effect stack @xs@ within @es@ as long as @xs@ is a</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- permutation (with possible duplicates) of a subset of @es@.</span><span>
</span><span id="line-429"></span><span class="hs-comment">--</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- Generalizes 'raise' and 'subsume'.</span><span>
</span><span id="line-431"></span><span class="hs-comment">--</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- &gt;&gt;&gt; data E1 :: Effect</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- &gt;&gt;&gt; data E2 :: Effect</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- &gt;&gt;&gt; data E3 :: Effect</span><span>
</span><span id="line-435"></span><span class="hs-comment">--</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- It makes it possible to rearrange the effect stack however you like:</span><span>
</span><span id="line-437"></span><span class="hs-comment">--</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-439"></span><span class="hs-comment">--   shuffle :: Eff (E3 : E1 : E2 : es) a -&gt; Eff (E1 : E2 : E3 : es) a</span><span>
</span><span id="line-440"></span><span class="hs-comment">--   shuffle = inject</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-442"></span><span class="hs-comment">--</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- It can also turn a monomorphic effect stack into a polymorphic one:</span><span>
</span><span id="line-444"></span><span class="hs-comment">--</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-446"></span><span class="hs-comment">--   toPoly :: (E1 :&gt; es, E2 :&gt; es, E3 :&gt; es) =&gt; Eff [E1, E2, E3] a -&gt; Eff es a</span><span>
</span><span id="line-447"></span><span class="hs-comment">--   toPoly = inject</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-449"></span><span class="hs-comment">--</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- Moreover, it allows for hiding specific effects from downstream:</span><span>
</span><span id="line-451"></span><span class="hs-comment">--</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-453"></span><span class="hs-comment">--   onlyE1 :: Eff (E1 : es) a -&gt; Eff (E1 : E2 : E3 : es) a</span><span>
</span><span id="line-454"></span><span class="hs-comment">--   onlyE1 = inject</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-456"></span><span class="hs-comment">--</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-458"></span><span class="hs-comment">--   onlyE2 :: Eff (E2 : es) a -&gt; Eff (E1 : E2 : E3 : es) a</span><span>
</span><span id="line-459"></span><span class="hs-comment">--   onlyE2 = inject</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-461"></span><span class="hs-comment">--</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-463"></span><span class="hs-comment">--   onlyE3 :: Eff (E3 : es) a -&gt; Eff (E1 : E2 : E3 : es) a</span><span>
</span><span id="line-464"></span><span class="hs-comment">--   onlyE3 = inject</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-466"></span><span class="hs-comment">--</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- However, it's not possible to inject a computation into an incompatible</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- effect stack:</span><span>
</span><span id="line-469"></span><span class="hs-comment">--</span><span>
</span><span id="line-470"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-471"></span><span class="hs-comment">--   coerceEs :: Eff es1 a -&gt; Eff es2 a</span><span>
</span><span id="line-472"></span><span class="hs-comment">--   coerceEs = inject</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- ...</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- ...Couldn't match type &#8216;es1&#8217; with &#8216;es2&#8217;</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- ...</span><span>
</span><span id="line-477"></span><span id="local-6989586621679075665"><span id="local-6989586621679075666"><span id="local-6989586621679075668"><span class="annot"><a href="Effectful.Internal.Monad.html#inject"><span class="hs-identifier hs-type">inject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#Subset"><span class="hs-identifier hs-type">Subset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075665"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075666"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075665"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075668"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075666"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075668"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-478"></span><span id="inject"><span class="annot"><span class="annottext">inject :: forall (xs :: [Effect]) (es :: [Effect]) a.
Subset xs es =&gt;
Eff xs a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#inject"><span class="hs-identifier hs-var hs-var">inject</span></a></span></span><span> </span><span id="local-6989586621679076234"><span class="annot"><span class="annottext">Eff xs a
</span><a href="#local-6989586621679076234"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076235"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076235"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff xs a -&gt; Env xs -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff xs a
</span><a href="#local-6989586621679076234"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Env xs -&gt; IO a) -&gt; IO (Env xs) -&gt; IO a
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO (Env xs)
forall (xs :: [Effect]) (es :: [Effect]).
Subset xs es =&gt;
Env es -&gt; IO (Env xs)
</span><a href="Effectful.Internal.Env.html#injectEnv"><span class="hs-identifier hs-var">injectEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076235"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- Dynamic dispatch</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">role</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#LocalEnv"><span class="hs-identifier hs-type">LocalEnv</span></a></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span> </span><span class="annot"><span class="hs-identifier">nominal</span></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-comment">-- | Opaque representation of the 'Eff' environment at the point of calling the</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- 'send' function, i.e. right before the control is passed to the effect</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- handler.</span><span>
</span><span id="line-488"></span><span class="hs-comment">--</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- The second type variable represents effects of a handler and is needed for</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- technical reasons to guarantee soundness (see</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- t'Effectful.Dispatch.Dynamic.SharedSuffix' for more information).</span><span>
</span><span id="line-492"></span><span class="hs-keyword">newtype</span><span> </span><span id="LocalEnv"><span class="annot"><a href="Effectful.Internal.Monad.html#LocalEnv"><span class="hs-identifier hs-var">LocalEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075704"><span class="annot"><a href="#local-6989586621679075704"><span class="hs-identifier hs-type">localEs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075705"><span class="annot"><a href="#local-6989586621679075705"><span class="hs-identifier hs-type">handlerEs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LocalEnv"><span class="annot"><a href="Effectful.Internal.Monad.html#LocalEnv"><span class="hs-identifier hs-var">LocalEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075704"><span class="hs-identifier hs-type">localEs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="annot"><span class="hs-comment">-- | Type signature of the effect handler.</span></span><span>
</span><span id="line-495"></span><span class="hs-keyword">type</span><span> </span><span id="EffectHandler"><span class="annot"><a href="Effectful.Internal.Monad.html#EffectHandler"><span class="hs-identifier hs-var">EffectHandler</span></a></span></span><span> </span><span id="local-6989586621679076238"><span class="annot"><a href="#local-6989586621679076238"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679076239"><span class="annot"><a href="#local-6989586621679076239"><span class="hs-identifier hs-type">es</span></a></span></span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679076240"><span class="annot"><a href="#local-6989586621679076240"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679076241"><span class="annot"><a href="#local-6989586621679076241"><span class="hs-identifier hs-type">localEs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679076238"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076241"><span class="hs-identifier hs-type">localEs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#LocalEnv"><span class="hs-identifier hs-type">LocalEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076241"><span class="hs-identifier hs-type">localEs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076239"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-comment">-- ^ Capture of the local environment for handling local 'Eff' computations</span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-comment">-- when @e@ is a higher order effect.</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679076238"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076241"><span class="hs-identifier hs-type">localEs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679076240"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The effect performed in the local environment.</span></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076239"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076240"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-comment">-- | An internal representation of dynamically dispatched effects, i.e. the</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- effect handler bundled with its environment.</span><span>
</span><span id="line-506"></span><span class="hs-keyword">data</span><span> </span><span id="Handler"><span class="annot"><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier hs-var">Handler</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>  </span><span id="local-6989586621679075683"><span id="local-6989586621679076242"><span id="Handler"><span class="annot"><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier hs-var">Handler</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076242"><span class="hs-identifier hs-type">handlerEs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#EffectHandler"><span class="hs-identifier hs-type">EffectHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075683"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076242"><span class="hs-identifier hs-type">handlerEs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075683"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-508"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="EffectRep"><span class="annot"><a href="Effectful.Internal.Env.html#EffectRep"><span class="hs-identifier hs-var">EffectRep</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span id="local-6989586621679075675"><span class="annot"><a href="Effectful.Internal.Monad.html#relinkHandler"><span class="hs-identifier hs-type">relinkHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Relinker"><span class="hs-identifier hs-type">Relinker</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075675"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-511"></span><span id="relinkHandler"><span class="annot"><span class="annottext">relinkHandler :: forall (e :: Effect). Relinker Handler e
</span><a href="Effectful.Internal.Monad.html#relinkHandler"><span class="hs-identifier hs-var hs-var">relinkHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((forall (es :: [Effect]). Env es -&gt; IO (Env es))
 -&gt; Handler e -&gt; IO (Handler e))
-&gt; Relinker Handler e
forall (a :: Effect -&gt; Type) (b :: Effect).
((forall (es :: [Effect]). Env es -&gt; IO (Env es))
 -&gt; a b -&gt; IO (a b))
-&gt; Relinker a b
</span><a href="Effectful.Internal.Env.html#Relinker"><span class="hs-identifier hs-var">Relinker</span></a></span><span> </span><span class="annot"><span class="annottext">(((forall (es :: [Effect]). Env es -&gt; IO (Env es))
  -&gt; Handler e -&gt; IO (Handler e))
 -&gt; Relinker Handler e)
-&gt; ((forall (es :: [Effect]). Env es -&gt; IO (Env es))
    -&gt; Handler e -&gt; IO (Handler e))
-&gt; Relinker Handler e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076245"><span class="annot"><span class="annottext">forall (es :: [Effect]). Env es -&gt; IO (Env es)
</span><a href="#local-6989586621679076245"><span class="hs-identifier hs-var">relink</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span id="local-6989586621679076248"><span class="annot"><span class="annottext">Env handlerEs
</span><a href="#local-6989586621679076248"><span class="hs-identifier hs-var">handlerEs</span></a></span></span><span> </span><span id="local-6989586621679076249"><span class="annot"><span class="annottext">EffectHandler e handlerEs
</span><a href="#local-6989586621679076249"><span class="hs-identifier hs-var">handler</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-512"></span><span>  </span><span id="local-6989586621679076250"><span class="annot"><span class="annottext">Env handlerEs
</span><a href="#local-6989586621679076250"><span class="hs-identifier hs-var">newHandlerEs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env handlerEs -&gt; IO (Env handlerEs)
forall (es :: [Effect]). Env es -&gt; IO (Env es)
</span><a href="#local-6989586621679076245"><span class="hs-identifier hs-var">relink</span></a></span><span> </span><span class="annot"><span class="annottext">Env handlerEs
</span><a href="#local-6989586621679076248"><span class="hs-identifier hs-var">handlerEs</span></a></span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><span class="annottext">Handler e -&gt; IO (Handler e)
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Handler e -&gt; IO (Handler e)) -&gt; Handler e -&gt; IO (Handler e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env handlerEs -&gt; EffectHandler e handlerEs -&gt; Handler e
forall (handlerEs :: [Effect]) (e :: Effect).
Env handlerEs -&gt; EffectHandler e handlerEs -&gt; Handler e
</span><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier hs-var">Handler</span></a></span><span> </span><span class="annot"><span class="annottext">Env handlerEs
</span><a href="#local-6989586621679076250"><span class="hs-identifier hs-var">newHandlerEs</span></a></span><span> </span><span class="annot"><span class="annottext">LocalEnv localEs handlerEs -&gt; e (Eff localEs) a -&gt; Eff handlerEs a
EffectHandler e handlerEs
</span><a href="#local-6989586621679076249"><span class="hs-identifier hs-var">handler</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="annot"><span class="hs-comment">-- | Run a dynamically dispatched effect with the given handler.</span></span><span>
</span><span id="line-516"></span><span id="local-6989586621679075687"><span id="local-6989586621679075688"><span id="local-6989586621679075689"><span class="annot"><a href="Effectful.Internal.Monad.html#runHandler"><span class="hs-identifier hs-type">runHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075687"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075687"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075687"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679075688"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075688"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075689"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-517"></span><span id="runHandler"><span class="annot"><span class="annottext">runHandler :: forall (e :: Effect) (es :: [Effect]) a.
(DispatchOf e ~ 'Dynamic) =&gt;
Handler e -&gt; Eff (e : es) a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#runHandler"><span class="hs-identifier hs-var hs-var">runHandler</span></a></span></span><span> </span><span id="local-6989586621679076258"><span class="annot"><span class="annottext">Handler e
</span><a href="#local-6989586621679076258"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679076259"><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076259"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076260"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076260"><span class="hs-identifier hs-var">es0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-518"></span><span>  </span><span class="annot"><span class="annottext">IO (Env (e : es))
-&gt; (Env (e : es) -&gt; IO ()) -&gt; (Env (e : es) -&gt; IO a) -&gt; IO a
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><a href="Effectful.Internal.Utils.html#inlineBracket"><span class="hs-identifier hs-var">inlineBracket</span></a></span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
-&gt; Relinker (EffectRep (DispatchOf e)) e
-&gt; Env es
-&gt; IO (Env (e : es))
forall (e :: Effect) (es :: [Effect]).
EffectRep (DispatchOf e) e
-&gt; Relinker (EffectRep (DispatchOf e)) e
-&gt; Env es
-&gt; IO (Env (e : es))
</span><a href="Effectful.Internal.Env.html#consEnv"><span class="hs-identifier hs-var">consEnv</span></a></span><span> </span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
Handler e
</span><a href="#local-6989586621679076258"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Relinker (EffectRep (DispatchOf e)) e
Relinker Handler e
forall (e :: Effect). Relinker Handler e
</span><a href="Effectful.Internal.Monad.html#relinkHandler"><span class="hs-identifier hs-var">relinkHandler</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076260"><span class="hs-identifier hs-var">es0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>    </span><span class="annot"><span class="annottext">Env (e : es) -&gt; IO ()
forall (e :: Effect) (es :: [Effect]). Env (e : es) -&gt; IO ()
</span><a href="Effectful.Internal.Env.html#unconsEnv"><span class="hs-identifier hs-var">unconsEnv</span></a></span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679076263"><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076263"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a -&gt; Env (e : es) -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076259"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076263"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="annot"><span class="hs-comment">-- | Send an operation of the given effect to its handler for execution.</span></span><span>
</span><span id="line-524"></span><span id="local-6989586621679075512"><span id="local-6989586621679075513"><span id="local-6989586621679075514"><span class="annot"><a href="Effectful.Internal.Monad.html#send"><span class="hs-identifier hs-type">send</span></a></span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075512"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075512"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075513"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075512"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075513"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075514"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-527"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The operation.</span></span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075513"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075514"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-529"></span><span id="send"><span class="annot"><span class="annottext">send :: forall (e :: Effect) (es :: [Effect]) a.
(HasCallStack, DispatchOf e ~ 'Dynamic, e :&gt; es) =&gt;
e (Eff es) a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#send"><span class="hs-identifier hs-var hs-var">send</span></a></span></span><span> </span><span id="local-6989586621679076270"><span class="annot"><span class="annottext">e (Eff es) a
</span><a href="#local-6989586621679076270"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076271"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076271"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-530"></span><span>  </span><span class="annot"><a href="Effectful.Internal.Monad.html#Handler"><span class="hs-identifier hs-type">Handler</span></a></span><span> </span><span id="local-6989586621679076274"><span class="annot"><span class="annottext">Env handlerEs
</span><a href="#local-6989586621679076274"><span class="hs-identifier hs-var">handlerEs</span></a></span></span><span> </span><span id="local-6989586621679076275"><span class="annot"><span class="annottext">EffectHandler e handlerEs
</span><a href="#local-6989586621679076275"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO (EffectRep (DispatchOf e) e)
forall (e :: Effect) (es :: [Effect]).
(e :&gt; es) =&gt;
Env es -&gt; IO (EffectRep (DispatchOf e) e)
</span><a href="Effectful.Internal.Env.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076271"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-comment">-- Prevent internal functions that rebind the effect handler from polluting</span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-comment">-- its call stack by freezing it. Note that functions 'interpret',</span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-comment">-- 'reinterpret', 'interpose' and 'impose' need to thaw it so that useful</span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-comment">-- stack frames from inside the effect handler continue to be added.</span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><span class="annottext">Eff handlerEs a -&gt; Env handlerEs -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HasCallStack =&gt;
 LocalEnv es handlerEs -&gt; e (Eff es) a -&gt; Eff handlerEs a)
-&gt; LocalEnv es handlerEs -&gt; e (Eff es) a -&gt; Eff handlerEs a
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">withFrozenCallStack</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt;
LocalEnv es handlerEs -&gt; e (Eff es) a -&gt; Eff handlerEs a
LocalEnv es handlerEs -&gt; e (Eff es) a -&gt; Eff handlerEs a
EffectHandler e handlerEs
</span><a href="#local-6989586621679076275"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env es -&gt; LocalEnv es handlerEs
forall (localEs :: [Effect]) (handlerEs :: [Effect]).
Env localEs -&gt; LocalEnv localEs handlerEs
</span><a href="Effectful.Internal.Monad.html#LocalEnv"><span class="hs-identifier hs-var">LocalEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076271"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e (Eff es) a
</span><a href="#local-6989586621679076270"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env handlerEs
</span><a href="#local-6989586621679076274"><span class="hs-identifier hs-var">handlerEs</span></a></span><span>
</span><span id="line-536"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#send"><span class="hs-pragma hs-type">send</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- Static dispatch</span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-comment">-- | Require the 'IOE' effect for running statically dispatched effects whose</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- operations perform side effects.</span><span>
</span><span id="line-543"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="MaybeIOE"><span class="annot"><a href="Effectful.Internal.Monad.html#MaybeIOE"><span class="hs-identifier hs-var">MaybeIOE</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679076280"><span class="annot"><a href="#local-6989586621679076280"><span class="hs-identifier hs-type">sideEffects</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#SideEffects"><span class="hs-identifier hs-type">SideEffects</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679076281"><span class="annot"><a href="#local-6989586621679076281"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constraint</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-544"></span><span>  </span><span id="MaybeIOE"><span class="annot"><a href="Effectful.Internal.Monad.html#MaybeIOE"><span class="hs-identifier hs-var">MaybeIOE</span></a></span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#NoSideEffects"><span class="hs-identifier hs-type">NoSideEffects</span></a></span><span>   </span><span class="annot"><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>  </span><span id="MaybeIOE"><span class="annot"><a href="Effectful.Internal.Monad.html#MaybeIOE"><span class="hs-identifier hs-var">MaybeIOE</span></a></span></span><span> </span><span id="local-6989586621679076283"><span class="annot"><a href="Effectful.Internal.Env.html#WithSideEffects"><span class="hs-identifier hs-type">WithSideEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076283"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#IOE"><span class="hs-identifier hs-type">IOE</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076283"><span class="hs-identifier hs-type">es</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="annot"><span class="hs-comment">-- | Internal representations of statically dispatched effects.</span></span><span>
</span><span id="line-548"></span><span class="hs-keyword">data</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="StaticRep"><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-var">StaticRep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679076284"><span class="annot"><a href="#local-6989586621679076284"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-549"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="EffectRep"><span class="annot"><a href="Effectful.Internal.Env.html#EffectRep"><span class="hs-identifier hs-var">EffectRep</span></a></span></span><span> </span><span id="local-6989586621679076285"><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679076285"><span class="hs-identifier hs-type">sideEffects</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-comment">-- | Run a statically dispatched effect with the given initial representation</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- and return the final value along with the final representation.</span><span>
</span><span id="line-553"></span><span id="local-6989586621679075706"><span id="local-6989586621679075707"><span id="local-6989586621679075708"><span id="local-6989586621679075709"><span class="annot"><a href="Effectful.Internal.Monad.html#runStaticRep"><span class="hs-identifier hs-type">runStaticRep</span></a></span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075706"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075707"><span class="hs-identifier hs-type">sideEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#MaybeIOE"><span class="hs-identifier hs-type">MaybeIOE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075707"><span class="hs-identifier hs-type">sideEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075708"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075706"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The initial representation.</span></span><span>
</span><span id="line-556"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075706"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679075708"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075709"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075708"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075709"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075706"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-558"></span><span id="runStaticRep"><span class="annot"><span class="annottext">runStaticRep :: forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect])
       a.
(DispatchOf e ~ 'Static sideEffects, MaybeIOE sideEffects es) =&gt;
StaticRep e -&gt; Eff (e : es) a -&gt; Eff es (a, StaticRep e)
</span><a href="Effectful.Internal.Monad.html#runStaticRep"><span class="hs-identifier hs-var hs-var">runStaticRep</span></a></span></span><span> </span><span id="local-6989586621679076293"><span class="annot"><span class="annottext">StaticRep e
</span><a href="#local-6989586621679076293"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span id="local-6989586621679076294"><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076294"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO (a, StaticRep e)) -&gt; Eff es (a, StaticRep e)
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO (a, StaticRep e)) -&gt; Eff es (a, StaticRep e))
-&gt; (Env es -&gt; IO (a, StaticRep e)) -&gt; Eff es (a, StaticRep e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076295"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076295"><span class="hs-identifier hs-var">es0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><span class="annottext">IO (Env (e : es))
-&gt; (Env (e : es) -&gt; IO ())
-&gt; (Env (e : es) -&gt; IO (a, StaticRep e))
-&gt; IO (a, StaticRep e)
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><a href="Effectful.Internal.Utils.html#inlineBracket"><span class="hs-identifier hs-var">inlineBracket</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
-&gt; Relinker (EffectRep (DispatchOf e)) e
-&gt; Env es
-&gt; IO (Env (e : es))
forall (e :: Effect) (es :: [Effect]).
EffectRep (DispatchOf e) e
-&gt; Relinker (EffectRep (DispatchOf e)) e
-&gt; Env es
-&gt; IO (Env (e : es))
</span><a href="Effectful.Internal.Env.html#consEnv"><span class="hs-identifier hs-var">consEnv</span></a></span><span> </span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
StaticRep e
</span><a href="#local-6989586621679076293"><span class="hs-identifier hs-var">e0</span></a></span><span> </span><span class="annot"><span class="annottext">Relinker (EffectRep (DispatchOf e)) e
Relinker StaticRep e
forall (rep :: Effect -&gt; Type) (e :: Effect). Relinker rep e
</span><a href="Effectful.Internal.Env.html#dummyRelinker"><span class="hs-identifier hs-var">dummyRelinker</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076295"><span class="hs-identifier hs-var">es0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>    </span><span class="annot"><span class="annottext">Env (e : es) -&gt; IO ()
forall (e :: Effect) (es :: [Effect]). Env (e : es) -&gt; IO ()
</span><a href="Effectful.Internal.Env.html#unconsEnv"><span class="hs-identifier hs-var">unconsEnv</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679076296"><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076296"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; StaticRep e -&gt; (a, StaticRep e))
-&gt; IO a -&gt; IO (StaticRep e -&gt; (a, StaticRep e))
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a -&gt; Env (e : es) -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076294"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076296"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">IO (StaticRep e -&gt; (a, StaticRep e))
-&gt; IO (StaticRep e) -&gt; IO (a, StaticRep e)
forall a b. IO (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Env (e : es) -&gt; IO (EffectRep (DispatchOf e) e)
forall (e :: Effect) (es :: [Effect]).
(e :&gt; es) =&gt;
Env es -&gt; IO (EffectRep (DispatchOf e) e)
</span><a href="Effectful.Internal.Env.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076296"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="hs-comment">-- | Run a statically dispatched effect with the given initial representation</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- and return the final value, discarding the final representation.</span><span>
</span><span id="line-566"></span><span id="local-6989586621679075621"><span id="local-6989586621679075622"><span id="local-6989586621679075623"><span id="local-6989586621679075624"><span class="annot"><a href="Effectful.Internal.Monad.html#evalStaticRep"><span class="hs-identifier hs-type">evalStaticRep</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075621"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075622"><span class="hs-identifier hs-type">sideEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#MaybeIOE"><span class="hs-identifier hs-type">MaybeIOE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075622"><span class="hs-identifier hs-type">sideEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075623"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075621"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The initial representation.</span></span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075621"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679075623"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075624"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075623"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075624"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-571"></span><span id="evalStaticRep"><span class="annot"><span class="annottext">evalStaticRep :: forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect])
       a.
(DispatchOf e ~ 'Static sideEffects, MaybeIOE sideEffects es) =&gt;
StaticRep e -&gt; Eff (e : es) a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#evalStaticRep"><span class="hs-identifier hs-var hs-var">evalStaticRep</span></a></span></span><span> </span><span id="local-6989586621679076300"><span class="annot"><span class="annottext">StaticRep e
</span><a href="#local-6989586621679076300"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679076301"><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076301"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076302"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076302"><span class="hs-identifier hs-var">es0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-572"></span><span>  </span><span class="annot"><span class="annottext">IO (Env (e : es))
-&gt; (Env (e : es) -&gt; IO ()) -&gt; (Env (e : es) -&gt; IO a) -&gt; IO a
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><a href="Effectful.Internal.Utils.html#inlineBracket"><span class="hs-identifier hs-var">inlineBracket</span></a></span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
-&gt; Relinker (EffectRep (DispatchOf e)) e
-&gt; Env es
-&gt; IO (Env (e : es))
forall (e :: Effect) (es :: [Effect]).
EffectRep (DispatchOf e) e
-&gt; Relinker (EffectRep (DispatchOf e)) e
-&gt; Env es
-&gt; IO (Env (e : es))
</span><a href="Effectful.Internal.Env.html#consEnv"><span class="hs-identifier hs-var">consEnv</span></a></span><span> </span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
StaticRep e
</span><a href="#local-6989586621679076300"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Relinker (EffectRep (DispatchOf e)) e
Relinker StaticRep e
forall (rep :: Effect -&gt; Type) (e :: Effect). Relinker rep e
</span><a href="Effectful.Internal.Env.html#dummyRelinker"><span class="hs-identifier hs-var">dummyRelinker</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076302"><span class="hs-identifier hs-var">es0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><span class="annottext">Env (e : es) -&gt; IO ()
forall (e :: Effect) (es :: [Effect]). Env (e : es) -&gt; IO ()
</span><a href="Effectful.Internal.Env.html#unconsEnv"><span class="hs-identifier hs-var">unconsEnv</span></a></span><span>
</span><span id="line-575"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679076303"><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076303"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a -&gt; Env (e : es) -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076301"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076303"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span class="hs-comment">-- | Run a statically dispatched effect with the given initial representation</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- and return the final representation, discarding the final value.</span><span>
</span><span id="line-579"></span><span id="local-6989586621679075720"><span id="local-6989586621679075721"><span id="local-6989586621679075722"><span id="local-6989586621679075723"><span class="annot"><a href="Effectful.Internal.Monad.html#execStaticRep"><span class="hs-identifier hs-type">execStaticRep</span></a></span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075720"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075721"><span class="hs-identifier hs-type">sideEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#MaybeIOE"><span class="hs-identifier hs-type">MaybeIOE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075721"><span class="hs-identifier hs-type">sideEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075722"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075720"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The initial representation.</span></span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075720"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679075722"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679075723"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075722"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075720"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-584"></span><span id="execStaticRep"><span class="annot"><span class="annottext">execStaticRep :: forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect])
       a.
(DispatchOf e ~ 'Static sideEffects, MaybeIOE sideEffects es) =&gt;
StaticRep e -&gt; Eff (e : es) a -&gt; Eff es (StaticRep e)
</span><a href="Effectful.Internal.Monad.html#execStaticRep"><span class="hs-identifier hs-var hs-var">execStaticRep</span></a></span></span><span> </span><span id="local-6989586621679076309"><span class="annot"><span class="annottext">StaticRep e
</span><a href="#local-6989586621679076309"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span id="local-6989586621679076310"><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076310"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO (StaticRep e)) -&gt; Eff es (StaticRep e)
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO (StaticRep e)) -&gt; Eff es (StaticRep e))
-&gt; (Env es -&gt; IO (StaticRep e)) -&gt; Eff es (StaticRep e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076311"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076311"><span class="hs-identifier hs-var">es0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-585"></span><span>  </span><span class="annot"><span class="annottext">IO (Env (e : es))
-&gt; (Env (e : es) -&gt; IO ())
-&gt; (Env (e : es) -&gt; IO (StaticRep e))
-&gt; IO (StaticRep e)
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><a href="Effectful.Internal.Utils.html#inlineBracket"><span class="hs-identifier hs-var">inlineBracket</span></a></span><span>
</span><span id="line-586"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
-&gt; Relinker (EffectRep (DispatchOf e)) e
-&gt; Env es
-&gt; IO (Env (e : es))
forall (e :: Effect) (es :: [Effect]).
EffectRep (DispatchOf e) e
-&gt; Relinker (EffectRep (DispatchOf e)) e
-&gt; Env es
-&gt; IO (Env (e : es))
</span><a href="Effectful.Internal.Env.html#consEnv"><span class="hs-identifier hs-var">consEnv</span></a></span><span> </span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
StaticRep e
</span><a href="#local-6989586621679076309"><span class="hs-identifier hs-var">e0</span></a></span><span> </span><span class="annot"><span class="annottext">Relinker (EffectRep (DispatchOf e)) e
Relinker StaticRep e
forall (rep :: Effect -&gt; Type) (e :: Effect). Relinker rep e
</span><a href="Effectful.Internal.Env.html#dummyRelinker"><span class="hs-identifier hs-var">dummyRelinker</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076311"><span class="hs-identifier hs-var">es0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><span class="annottext">Env (e : es) -&gt; IO ()
forall (e :: Effect) (es :: [Effect]). Env (e : es) -&gt; IO ()
</span><a href="Effectful.Internal.Env.html#unconsEnv"><span class="hs-identifier hs-var">unconsEnv</span></a></span><span>
</span><span id="line-588"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679076312"><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076312"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a -&gt; Env (e : es) -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (e : es) a
</span><a href="#local-6989586621679076310"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076312"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO (StaticRep e) -&gt; IO (StaticRep e)
forall a b. IO a -&gt; IO b -&gt; IO b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Env (e : es) -&gt; IO (EffectRep (DispatchOf e) e)
forall (e :: Effect) (es :: [Effect]).
(e :&gt; es) =&gt;
Env es -&gt; IO (EffectRep (DispatchOf e) e)
</span><a href="Effectful.Internal.Env.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env (e : es)
</span><a href="#local-6989586621679076312"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="annot"><span class="hs-comment">-- | Fetch the current representation of the effect.</span></span><span>
</span><span id="line-591"></span><span id="local-6989586621679075394"><span id="local-6989586621679075395"><span id="local-6989586621679075396"><span class="annot"><a href="Effectful.Internal.Monad.html#getStaticRep"><span class="hs-identifier hs-type">getStaticRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075394"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075395"><span class="hs-identifier hs-type">sideEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075394"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075396"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075396"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075394"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-592"></span><span id="getStaticRep"><span class="annot"><span class="annottext">getStaticRep :: forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect]).
(DispatchOf e ~ 'Static sideEffects, e :&gt; es) =&gt;
Eff es (StaticRep e)
</span><a href="Effectful.Internal.Monad.html#getStaticRep"><span class="hs-identifier hs-var hs-var">getStaticRep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO (StaticRep e)) -&gt; Eff es (StaticRep e)
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO (StaticRep e)) -&gt; Eff es (StaticRep e))
-&gt; (Env es -&gt; IO (StaticRep e)) -&gt; Eff es (StaticRep e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076317"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076317"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; IO (EffectRep (DispatchOf e) e)
forall (e :: Effect) (es :: [Effect]).
(e :&gt; es) =&gt;
Env es -&gt; IO (EffectRep (DispatchOf e) e)
</span><a href="Effectful.Internal.Env.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076317"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="annot"><span class="hs-comment">-- | Set the current representation of the effect to the given value.</span></span><span>
</span><span id="line-595"></span><span id="local-6989586621679075731"><span id="local-6989586621679075732"><span id="local-6989586621679075733"><span class="annot"><a href="Effectful.Internal.Monad.html#putStaticRep"><span class="hs-identifier hs-type">putStaticRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075731"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075732"><span class="hs-identifier hs-type">sideEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075731"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075733"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075731"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075733"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-596"></span><span id="putStaticRep"><span class="annot"><span class="annottext">putStaticRep :: forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect]).
(DispatchOf e ~ 'Static sideEffects, e :&gt; es) =&gt;
StaticRep e -&gt; Eff es ()
</span><a href="Effectful.Internal.Monad.html#putStaticRep"><span class="hs-identifier hs-var hs-var">putStaticRep</span></a></span></span><span> </span><span id="local-6989586621679076322"><span class="annot"><span class="annottext">StaticRep e
</span><a href="#local-6989586621679076322"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO ()) -&gt; Eff es ()
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO ()) -&gt; Eff es ()) -&gt; (Env es -&gt; IO ()) -&gt; Eff es ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076323"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076323"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; EffectRep (DispatchOf e) e -&gt; IO ()
forall (e :: Effect) (es :: [Effect]).
(e :&gt; es) =&gt;
Env es -&gt; EffectRep (DispatchOf e) e -&gt; IO ()
</span><a href="Effectful.Internal.Env.html#putEnv"><span class="hs-identifier hs-var">putEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076323"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
StaticRep e
</span><a href="#local-6989586621679076322"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span class="hs-comment">-- | Apply the function to the current representation of the effect and return a</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- value.</span><span>
</span><span id="line-600"></span><span id="local-6989586621679075739"><span id="local-6989586621679075740"><span id="local-6989586621679075741"><span id="local-6989586621679075742"><span class="annot"><a href="Effectful.Internal.Monad.html#stateStaticRep"><span class="hs-identifier hs-type">stateStaticRep</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075739"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075740"><span class="hs-identifier hs-type">sideEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075739"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075741"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075739"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075742"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075739"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The function to modify the representation.</span></span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075741"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075742"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-605"></span><span id="stateStaticRep"><span class="annot"><span class="annottext">stateStaticRep :: forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect])
       a.
(DispatchOf e ~ 'Static sideEffects, e :&gt; es) =&gt;
(StaticRep e -&gt; (a, StaticRep e)) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#stateStaticRep"><span class="hs-identifier hs-var hs-var">stateStaticRep</span></a></span></span><span> </span><span id="local-6989586621679076329"><span class="annot"><span class="annottext">StaticRep e -&gt; (a, StaticRep e)
</span><a href="#local-6989586621679076329"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076330"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076330"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es
-&gt; (EffectRep (DispatchOf e) e
    -&gt; IO (a, EffectRep (DispatchOf e) e))
-&gt; IO a
forall (e :: Effect) (es :: [Effect]) a.
(e :&gt; es) =&gt;
Env es
-&gt; (EffectRep (DispatchOf e) e
    -&gt; IO (a, EffectRep (DispatchOf e) e))
-&gt; IO a
</span><a href="Effectful.Internal.Env.html#stateEnv"><span class="hs-identifier hs-var">stateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076330"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, StaticRep e) -&gt; IO (a, StaticRep e)
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((a, StaticRep e) -&gt; IO (a, StaticRep e))
-&gt; (StaticRep e -&gt; (a, StaticRep e))
-&gt; StaticRep e
-&gt; IO (a, StaticRep e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StaticRep e -&gt; (a, StaticRep e)
</span><a href="#local-6989586621679076329"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-comment">-- | Apply the monadic function to the current representation of the effect and</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- return a value.</span><span>
</span><span id="line-609"></span><span id="local-6989586621679075750"><span id="local-6989586621679075751"><span id="local-6989586621679075752"><span id="local-6989586621679075753"><span class="annot"><a href="Effectful.Internal.Monad.html#stateStaticRepM"><span class="hs-identifier hs-type">stateStaticRepM</span></a></span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075750"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075751"><span class="hs-identifier hs-type">sideEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075750"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075752"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075750"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075752"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075750"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The function to modify the representation.</span></span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075752"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075753"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-614"></span><span id="stateStaticRepM"><span class="annot"><span class="annottext">stateStaticRepM :: forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect])
       a.
(DispatchOf e ~ 'Static sideEffects, e :&gt; es) =&gt;
(StaticRep e -&gt; Eff es (a, StaticRep e)) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#stateStaticRepM"><span class="hs-identifier hs-var hs-var">stateStaticRepM</span></a></span></span><span> </span><span id="local-6989586621679076335"><span class="annot"><span class="annottext">StaticRep e -&gt; Eff es (a, StaticRep e)
</span><a href="#local-6989586621679076335"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076336"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076336"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((forall a. IO a -&gt; IO a) -&gt; IO a) -&gt; IO a
forall b. ((forall a. IO a -&gt; IO a) -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">E.mask</span></span><span> </span><span class="annot"><span class="annottext">(((forall a. IO a -&gt; IO a) -&gt; IO a) -&gt; IO a)
-&gt; ((forall a. IO a -&gt; IO a) -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076337"><span class="annot"><span class="annottext">forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679076337"><span class="hs-identifier hs-var">unmask</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-615"></span><span>  </span><span class="annot"><span class="annottext">Env es
-&gt; (EffectRep (DispatchOf e) e
    -&gt; IO (a, EffectRep (DispatchOf e) e))
-&gt; IO a
forall (e :: Effect) (es :: [Effect]) a.
(e :&gt; es) =&gt;
Env es
-&gt; (EffectRep (DispatchOf e) e
    -&gt; IO (a, EffectRep (DispatchOf e) e))
-&gt; IO a
</span><a href="Effectful.Internal.Env.html#stateEnv"><span class="hs-identifier hs-var">stateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076336"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">((EffectRep (DispatchOf e) e -&gt; IO (a, EffectRep (DispatchOf e) e))
 -&gt; IO a)
-&gt; (EffectRep (DispatchOf e) e
    -&gt; IO (a, EffectRep (DispatchOf e) e))
-&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (a, StaticRep e) -&gt; IO (a, StaticRep e)
forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679076337"><span class="hs-identifier hs-var">unmask</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (a, StaticRep e) -&gt; IO (a, StaticRep e))
-&gt; (StaticRep e -&gt; IO (a, StaticRep e))
-&gt; StaticRep e
-&gt; IO (a, StaticRep e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eff es (a, StaticRep e) -&gt; Env es -&gt; IO (a, StaticRep e)
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-operator hs-var">`unEff`</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076336"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff es (a, StaticRep e) -&gt; IO (a, StaticRep e))
-&gt; (StaticRep e -&gt; Eff es (a, StaticRep e))
-&gt; StaticRep e
-&gt; IO (a, StaticRep e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StaticRep e -&gt; Eff es (a, StaticRep e)
</span><a href="#local-6989586621679076335"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">-- | Execute a computation with a temporarily modified representation of the</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- effect.</span><span>
</span><span id="line-619"></span><span id="local-6989586621679075403"><span id="local-6989586621679075404"><span id="local-6989586621679075405"><span id="local-6989586621679075406"><span class="annot"><a href="Effectful.Internal.Monad.html#localStaticRep"><span class="hs-identifier hs-type">localStaticRep</span></a></span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Env.html#DispatchOf"><span class="hs-identifier hs-type">DispatchOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075403"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Effectful.Internal.Env.html#Static"><span class="hs-identifier hs-type">Static</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075404"><span class="hs-identifier hs-type">sideEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075403"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075405"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075403"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#StaticRep"><span class="hs-identifier hs-type">StaticRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075403"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The function to temporarily modify the representation.</span></span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075405"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075406"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075405"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075406"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-625"></span><span id="localStaticRep"><span class="annot"><span class="annottext">localStaticRep :: forall (e :: Effect) (sideEffects :: SideEffects) (es :: [Effect])
       a.
(DispatchOf e ~ 'Static sideEffects, e :&gt; es) =&gt;
(StaticRep e -&gt; StaticRep e) -&gt; Eff es a -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#localStaticRep"><span class="hs-identifier hs-var hs-var">localStaticRep</span></a></span></span><span> </span><span id="local-6989586621679076344"><span class="annot"><span class="annottext">StaticRep e -&gt; StaticRep e
</span><a href="#local-6989586621679076344"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679076345"><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076345"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env es -&gt; IO a) -&gt; Eff es a
forall (es :: [Effect]) a. (Env es -&gt; IO a) -&gt; Eff es a
</span><a href="Effectful.Internal.Monad.html#unsafeEff"><span class="hs-identifier hs-var">unsafeEff</span></a></span><span> </span><span class="annot"><span class="annottext">((Env es -&gt; IO a) -&gt; Eff es a) -&gt; (Env es -&gt; IO a) -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076346"><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076346"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-626"></span><span>  </span><span class="annot"><span class="annottext">IO (StaticRep e)
-&gt; (StaticRep e -&gt; IO ()) -&gt; (StaticRep e -&gt; IO a) -&gt; IO a
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><a href="Effectful.Internal.Utils.html#inlineBracket"><span class="hs-identifier hs-var">inlineBracket</span></a></span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env es
-&gt; (EffectRep (DispatchOf e) e
    -&gt; IO (StaticRep e, EffectRep (DispatchOf e) e))
-&gt; IO (StaticRep e)
forall (e :: Effect) (es :: [Effect]) a.
(e :&gt; es) =&gt;
Env es
-&gt; (EffectRep (DispatchOf e) e
    -&gt; IO (a, EffectRep (DispatchOf e) e))
-&gt; IO a
</span><a href="Effectful.Internal.Env.html#stateEnv"><span class="hs-identifier hs-var">stateEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076346"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">((EffectRep (DispatchOf e) e
  -&gt; IO (StaticRep e, EffectRep (DispatchOf e) e))
 -&gt; IO (StaticRep e))
-&gt; (EffectRep (DispatchOf e) e
    -&gt; IO (StaticRep e, EffectRep (DispatchOf e) e))
-&gt; IO (StaticRep e)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679076347"><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
</span><a href="#local-6989586621679076347"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StaticRep e, StaticRep e) -&gt; IO (StaticRep e, StaticRep e)
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
StaticRep e
</span><a href="#local-6989586621679076347"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StaticRep e -&gt; StaticRep e
</span><a href="#local-6989586621679076344"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
StaticRep e
</span><a href="#local-6989586621679076347"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679076348"><span class="annot"><span class="annottext">StaticRep e
</span><a href="#local-6989586621679076348"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env es -&gt; EffectRep (DispatchOf e) e -&gt; IO ()
forall (e :: Effect) (es :: [Effect]).
(e :&gt; es) =&gt;
Env es -&gt; EffectRep (DispatchOf e) e -&gt; IO ()
</span><a href="Effectful.Internal.Env.html#putEnv"><span class="hs-identifier hs-var">putEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076346"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">EffectRep (DispatchOf e) e
StaticRep e
</span><a href="#local-6989586621679076348"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">StaticRep e
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff es a -&gt; Env es -&gt; IO a
forall (es :: [Effect]) a. Eff es a -&gt; Env es -&gt; IO a
</span><a href="Effectful.Internal.Monad.html#unEff"><span class="hs-identifier hs-var">unEff</span></a></span><span> </span><span class="annot"><span class="annottext">Eff es a
</span><a href="#local-6989586621679076345"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Env es
</span><a href="#local-6989586621679076346"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span></pre></body></html>